import{r as u,j as e,o,s as N,a_ as D,aU as w,F as T,a$ as A,ax as $,b0 as R,b1 as U,az as I,aA as P,aB as E,b2 as C,aP as M,aa as B,b3 as L,H as z,X as G,Z as F,g as H,f as O,a8 as K,b4 as W,v as Z}from"./vendor-DukLKV3j.js";import{N as Y}from"./Navigation-B2R97OZ2.js";import{C as f,a as y,b,c as k,d as v}from"./card-CaBTdLYZ.js";import{B as p}from"./badge-CL0qBMqV.js";import{B as j}from"./button-DnCoHbkF.js";import{u as S,c as J}from"./index-DMsRMC1O.js";import{a as X}from"./ThreatIntelCard-D_YF9jFw.js";function _({className:i}){const{riskHeatmap:d,isConnected:n}=S(),{gridData:r,labels:s}=u.useMemo(()=>d.grid.length>0?{gridData:d.grid,labels:d.labels}:{gridData:[[.1,.1,.1,.1,.1,.1,.1],[.1,.1,.1,.1,.1,.1,.1],[.1,.1,.1,.1,.1,.1,.1],[.1,.1,.1,.1,.1,.1,.1],[.1,.1,.1,.1,.1,.1,.1],[.1,.1,.1,.1,.1,.1,.1]],labels:{x:["EN","DE","FR","ES","JA","ZH","COM"],y:["Main","Talk","User","Wiki","File","Template"]}},[d]),c=l=>l>=.8?"hsl(var(--critical))":l>=.6?"hsl(var(--anomaly))":l>=.4?"hsl(var(--info))":"hsl(var(--primary) / 0.3)",h=l=>.3+l*.7;return e.jsxs("div",{className:J("relative bg-card/50 rounded-xl p-4 border border-border/50",i),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Risk Heatmap"}),e.jsx("span",{className:"text-[10px] text-muted-foreground",children:"Wiki × Namespace"}),n&&e.jsx(o.div,{className:"w-1.5 h-1.5 rounded-full bg-success",animate:{opacity:[.5,1,.5]},transition:{duration:2,repeat:1/0}})]}),e.jsxs("div",{className:"flex gap-2 text-[9px]",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-primary/30"}),e.jsx("span",{className:"text-muted-foreground",children:"Low"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-info"}),e.jsx("span",{className:"text-muted-foreground",children:"Med"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-anomaly"}),e.jsx("span",{className:"text-muted-foreground",children:"High"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-critical"}),e.jsx("span",{className:"text-muted-foreground",children:"Critical"})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex flex-col gap-1 pt-5",children:s.y.map(l=>e.jsx("div",{className:"h-8 flex items-center text-[10px] text-muted-foreground",children:l},l))}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex gap-1 mb-1",children:s.x.map(l=>e.jsx("div",{className:"flex-1 text-center text-[10px] text-muted-foreground",children:l},l))}),e.jsx("div",{className:"space-y-1",children:r.map((l,t)=>e.jsx("div",{className:"flex gap-1",children:l.map((a,m)=>e.jsx(o.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:(t*l.length+m)*.01},className:"flex-1 h-8 rounded cursor-pointer transition-transform hover:scale-105 relative",style:{backgroundColor:c(a),opacity:h(a)},title:`${s.y[t]} × ${s.x[m]}: ${(a*100).toFixed(0)}% risk`,children:a>=.8&&e.jsx(o.div,{className:"absolute inset-0 rounded",animate:{opacity:[.5,1,.5]},transition:{duration:1.5,repeat:1/0},style:{backgroundColor:"hsl(var(--critical) / 0.3)"}})},`${t}-${m}`))},t))})]})]}),!n&&e.jsx("p",{className:"text-[10px] text-muted-foreground mt-3 text-center",children:"Connect to Wikipedia stream to see live risk distribution"})]})}function V(){const[i,d]=u.useState([]);u.useEffect(()=>{const r=[{ip:"192.168.45.123",reputation:"malicious",score:95,country:"RU",firstSeen:new Date(Date.now()-6048e5),lastSeen:new Date,threatCount:45,tags:["botnet","c2","malware"]},{ip:"45.142.34.98",reputation:"suspicious",score:68,country:"CN",firstSeen:new Date(Date.now()-2592e5),lastSeen:new Date(Date.now()-36e5),threatCount:12,tags:["scanning","reconnaissance"]},{ip:"203.45.67.89",reputation:"clean",score:15,country:"US",firstSeen:new Date(Date.now()-2592e6),lastSeen:new Date(Date.now()-864e5),threatCount:0,tags:["cdn","legitimate"]}];d(r)},[]);const n={malicious:"bg-red-500/10 text-red-500 border-red-500/30",suspicious:"bg-orange-500/10 text-orange-500 border-orange-500/30",clean:"bg-green-500/10 text-green-500 border-green-500/30",unknown:"bg-gray-500/10 text-gray-500 border-gray-500/30"};return e.jsxs(f,{children:[e.jsx(y,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(N,{className:"w-5 h-5"}),"IP Reputation Tracker"]}),e.jsx(k,{children:"Real-time threat intelligence for monitored IPs"})]}),e.jsx(j,{size:"sm",variant:"outline",children:"Add IP"})]})}),e.jsx(v,{children:e.jsx("div",{className:"space-y-3",children:i.map((r,s)=>e.jsxs(o.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:s*.1},className:"p-4 border border-border/50 rounded-lg hover:border-primary/30 transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("code",{className:"text-sm font-mono font-semibold",children:r.ip}),e.jsx(p,{variant:"outline",className:n[r.reputation],children:r.reputation})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(D,{className:"w-3 h-3"}),r.country]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(w,{className:"w-3 h-3"}),r.threatCount," threats"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold text-primary",children:r.score}),e.jsx("div",{className:"text-[10px] text-muted-foreground",children:"threat score"})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("div",{className:"flex gap-1",children:r.tags.map((c,h)=>e.jsx(p,{variant:"secondary",className:"text-[9px]",children:c},h))}),e.jsxs("div",{className:"text-muted-foreground",children:["Last seen: ",r.lastSeen.toLocaleTimeString()]})]}),e.jsx("div",{className:"mt-2 h-1 bg-muted rounded-full overflow-hidden",children:e.jsx(o.div,{initial:{width:0},animate:{width:`${r.score}%`},className:`h-full ${r.score>80?"bg-red-500":r.score>50?"bg-orange-500":"bg-green-500"}`})})]},r.ip))})})]})}function q(){const[i,d]=u.useState("24h"),[n,r]=u.useState([]);u.useEffect(()=>{r((()=>{const a=i==="1h"?12:i==="24h"?24:i==="7d"?14:30;return Array.from({length:a},(m,x)=>({time:i==="1h"?`${String(x*5).padStart(2,"0")}m`:i==="24h"?`${String(x).padStart(2,"0")}:00`:i==="7d"?`Day ${x+1}`:`Day ${x+1}`,threats:Math.floor(Math.random()*50)+10,anomalies:Math.floor(Math.random()*20)+5,normalEvents:Math.floor(Math.random()*100)+50}))})())},[i]);const s=()=>{const t=[["Time","Threats","Anomalies","Normal Events"],...n.map(g=>[g.time,g.threats,g.anomalies,g.normalEvents])].map(g=>g.join(",")).join(`
`),a=new Blob([t],{type:"text/csv"}),m=URL.createObjectURL(a),x=document.createElement("a");x.href=m,x.download=`threat-trends-${i}-${Date.now()}.csv`,x.click()},c=n.reduce((t,a)=>t+a.threats,0),h=n.length>0?Math.round(c/n.length):0,l=n.length>1&&n[0].threats>0?(n[n.length-1].threats-n[0].threats)/n[0].threats*100:0;return e.jsxs(f,{children:[e.jsx(y,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5"}),"Historical Trends"]}),e.jsx(k,{children:"Threat activity over time"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(j,{size:"sm",variant:"outline",onClick:s,children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Export"]})})]})}),e.jsxs(v,{children:[e.jsx("div",{className:"flex gap-2 mb-6",children:["1h","24h","7d","30d"].map(t=>e.jsx(j,{size:"sm",variant:i===t?"default":"outline",onClick:()=>d(t),children:t},t))}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"p-3 bg-card border border-border/50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-500",children:c}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Threats"})]}),e.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"p-3 bg-card border border-border/50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:h}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Avg per Period"})]}),e.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"p-3 bg-card border border-border/50 rounded-lg",children:[e.jsxs("div",{className:`text-2xl font-bold ${l>0?"text-red-500":"text-green-500"}`,children:[l>0?"+":"",l.toFixed(1),"%"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Trend"})]})]}),e.jsx($,{width:"100%",height:250,children:e.jsxs(R,{data:n,children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"threatsGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#ef4444",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#ef4444",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"anomaliesGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#f59e0b",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#f59e0b",stopOpacity:0})]})]}),e.jsx(U,{strokeDasharray:"3 3",stroke:"hsl(var(--border))"}),e.jsx(I,{dataKey:"time",stroke:"hsl(var(--muted-foreground))",style:{fontSize:"10px"}}),e.jsx(P,{stroke:"hsl(var(--muted-foreground))",style:{fontSize:"10px"}}),e.jsx(E,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"8px"}}),e.jsx(C,{type:"monotone",dataKey:"threats",stroke:"#ef4444",fillOpacity:1,fill:"url(#threatsGradient)"}),e.jsx(C,{type:"monotone",dataKey:"anomalies",stroke:"#f59e0b",fillOpacity:1,fill:"url(#anomaliesGradient)"})]})}),e.jsxs("div",{className:"flex justify-center gap-6 mt-4 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),e.jsx("span",{className:"text-muted-foreground",children:"Threats"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-500"}),e.jsx("span",{className:"text-muted-foreground",children:"Anomalies"})]})]})]})]})}function Q(){const[i,d]=u.useState([]);u.useEffect(()=>{d([{country:"Russia",code:"RU",lat:55.7558,lng:37.6173,threats:245,severity:"critical"},{country:"China",code:"CN",lat:39.9042,lng:116.4074,threats:189,severity:"high"},{country:"United States",code:"US",lat:38.9072,lng:-77.0369,threats:156,severity:"high"},{country:"Brazil",code:"BR",lat:-15.7975,lng:-47.8919,threats:98,severity:"medium"},{country:"India",code:"IN",lat:28.6139,lng:77.209,threats:87,severity:"medium"},{country:"Germany",code:"DE",lat:52.52,lng:13.405,threats:45,severity:"low"}])},[]);const n={critical:"bg-red-500",high:"bg-orange-500",medium:"bg-yellow-500",low:"bg-blue-500"},r=Math.max(...i.map(s=>s.threats));return e.jsxs(f,{children:[e.jsxs(y,{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5"}),"Global Threat Map"]}),e.jsx(k,{children:"Geographic distribution of threat activity"})]}),e.jsxs(v,{children:[e.jsxs("div",{className:"relative w-full h-64 bg-muted/30 rounded-lg overflow-hidden mb-4",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 to-transparent"}),i.map((s,c)=>{const h=20+s.threats/r*40,l=(s.lng+180)/360*100,t=(90-s.lat)/180*100;return e.jsx(o.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{delay:c*.1},className:"absolute",style:{left:`${l}%`,top:`${t}%`,transform:"translate(-50%, -50%)"},children:e.jsxs("div",{className:"relative group",children:[e.jsx(o.div,{animate:{scale:[1,1.2,1],opacity:[.5,.8,.5]},transition:{duration:2,repeat:1/0,delay:c*.2},className:`w-${Math.floor(h/4)} h-${Math.floor(h/4)} ${n[s.severity]} rounded-full blur-md`,style:{width:h,height:h}}),e.jsx("div",{className:`absolute inset-0 ${n[s.severity]} rounded-full`,style:{width:h*.5,height:h*.5,left:"25%",top:"25%"}}),e.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 hidden group-hover:block z-10",children:e.jsxs("div",{className:"bg-card border border-border shadow-lg rounded-lg p-2 whitespace-nowrap",children:[e.jsx("div",{className:"text-xs font-semibold",children:s.country}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[s.threats," threats"]}),e.jsx(p,{variant:"outline",className:"text-[9px] mt-1",children:s.severity})]})})]})},s.code)})]}),e.jsx("div",{className:"space-y-2",children:i.sort((s,c)=>c.threats-s.threats).map((s,c)=>e.jsxs(o.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:c*.05},className:"flex items-center justify-between p-2 bg-muted/30 rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 ${n[s.severity]} rounded-full`}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:s.country}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[s.lat.toFixed(2),"°, ",s.lng.toFixed(2),"°"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold",children:s.threats}),e.jsx("div",{className:"text-[10px] text-muted-foreground",children:"threats"})]})]},s.code))}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-border/50 grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold text-primary",children:i.length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Countries"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold text-red-500",children:i.reduce((s,c)=>s+c.threats,0)}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Threats"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold text-orange-500",children:i.filter(s=>s.severity==="critical"||s.severity==="high").length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"High Risk"})]})]})]})]})}function ee(){const[i,d]=u.useState([{id:"1",timestamp:new Date(Date.now()-3e5),title:"Critical: Ransomware Detected",message:"WannaCry variant detected on 5 endpoints",severity:"critical",read:!1,acknowledged:!1},{id:"2",timestamp:new Date(Date.now()-6e5),title:"Suspicious Network Activity",message:"Unusual outbound traffic to unknown IP 45.142.34.98",severity:"warning",read:!1,acknowledged:!1},{id:"3",timestamp:new Date(Date.now()-12e5),title:"System Update Available",message:"New threat signatures available for download",severity:"info",read:!0,acknowledged:!0}]),n=t=>{d(i.map(a=>a.id===t?{...a,acknowledged:!0,read:!0}:a))},r=t=>{d(i.filter(a=>a.id!==t))},s=t=>{d(i.map(a=>a.id===t?{...a,read:!0}:a))},c={critical:{icon:w,color:"text-red-500",bg:"bg-red-500/10",border:"border-red-500/30"},warning:{icon:w,color:"text-orange-500",bg:"bg-orange-500/10",border:"border-orange-500/30"},info:{icon:L,color:"text-blue-500",bg:"bg-blue-500/10",border:"border-blue-500/30"}},h=i.filter(t=>!t.read).length,l=i.filter(t=>!t.acknowledged).length;return e.jsxs(f,{children:[e.jsx(y,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5"}),"Alert Management",h>0&&e.jsxs(p,{variant:"destructive",className:"text-xs",children:[h," new"]})]}),e.jsx(k,{children:"Real-time security alerts and notifications"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(j,{size:"sm",variant:"outline",onClick:()=>d(i.map(t=>({...t,read:!0}))),children:"Mark All Read"})})]})}),e.jsxs(v,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[e.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-500",children:i.filter(t=>t.severity==="critical").length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Critical"})]}),e.jsxs("div",{className:"p-3 bg-orange-500/10 border border-orange-500/30 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-500",children:i.filter(t=>t.severity==="warning").length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Warning"})]}),e.jsxs("div",{className:"p-3 bg-blue-500/10 border border-blue-500/30 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-500",children:l}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Pending"})]})]}),e.jsx("div",{className:"space-y-2",children:e.jsx(B,{children:i.map((t,a)=>{const m=c[t.severity],x=m.icon;return e.jsx(o.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20,height:0},transition:{delay:a*.05},className:`p-4 border ${m.border} ${m.bg} rounded-lg ${t.read?"":"font-semibold"}`,onClick:()=>!t.read&&s(t.id),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(x,{className:`w-5 h-5 ${m.color} mt-0.5 shrink-0`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[e.jsx("h4",{className:"text-sm font-medium",children:t.title}),!t.read&&e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full shrink-0 mt-1.5"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:t.message}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-[10px] text-muted-foreground",children:t.timestamp.toLocaleTimeString()}),e.jsxs("div",{className:"flex gap-2",children:[!t.acknowledged&&e.jsxs(j,{size:"sm",variant:"ghost",className:"h-7 text-xs",onClick:g=>{g.stopPropagation(),n(t.id)},children:[e.jsx(z,{className:"w-3 h-3 mr-1"}),"Acknowledge"]}),e.jsxs(j,{size:"sm",variant:"ghost",className:"h-7 text-xs",onClick:g=>{g.stopPropagation(),r(t.id)},children:[e.jsx(G,{className:"w-3 h-3 mr-1"}),"Dismiss"]})]})]})]})]})},t.id)})})}),i.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(M,{className:"w-12 h-12 mx-auto mb-2 opacity-20"}),e.jsx("p",{className:"text-sm",children:"No alerts at this time"})]})]})]})}function te(){const i=["malware","phishing","intrusion","vulnerability"],d=["critical","high","medium","low"],n=["RU","CN","US","BR","IN","KR","DE","FR","GB","JP"],r=i[Math.floor(Math.random()*i.length)],s=d[Math.floor(Math.random()*d.length)],c=()=>`${Math.floor(Math.random()*256)}.${Math.floor(Math.random()*256)}.${Math.floor(Math.random()*256)}.${Math.floor(Math.random()*256)}`;return{id:crypto.randomUUID(),timestamp:new Date,source:"Kaspersky Threat Intelligence",threatType:r,severity:s,indicator:c(),indicatorType:"ip",confidence:70+Math.random()*30,country:n[Math.floor(Math.random()*n.length)],description:`${r.toUpperCase()} activity detected via Kaspersky Global Threat Network`,tags:["kaspersky",r,s,"apt"]}}function se(){const i=["zeus","emotet","trickbot","ryuk","wannacry","locky"],d=i[Math.floor(Math.random()*i.length)],n=()=>`malicious-${Math.random().toString(36).substr(2,8)}.com`;return{id:crypto.randomUUID(),timestamp:new Date,source:"Bitdefender Threat Intel",threatType:"malware",severity:Math.random()>.7?"critical":"high",indicator:n(),indicatorType:"domain",confidence:80+Math.random()*20,description:`${d.toUpperCase()} malware family detected by GravityZone`,tags:["bitdefender","malware",d,"c2"]}}function ae(){const i=["file-encryption","registry-modification","network-scan","credential-theft"],d=i[Math.floor(Math.random()*i.length)],n=()=>Array.from({length:64},()=>Math.floor(Math.random()*16).toString(16)).join("");return{id:crypto.randomUUID(),timestamp:new Date,source:"ANY.RUN Sandbox",threatType:"malware",severity:d==="file-encryption"?"critical":"high",indicator:n(),indicatorType:"hash",confidence:90+Math.random()*10,description:`Behavioral analysis: ${d} detected in sandbox environment`,tags:["anyrun","sandbox",d,"dynamic-analysis"]}}const me=()=>{const{totalEventsProcessed:i,eventsPerSecond:d,anomalies:n,bettiNumbers:r,isConnected:s}=S(),[c,h]=u.useState([]);u.useEffect(()=>{const a=()=>{const x=[];for(let g=0;g<3;g++)Math.random()>.5&&x.push(te()),Math.random()>.5&&x.push(se()),Math.random()>.7&&x.push(ae());h(x.slice(0,6))};a();const m=setInterval(a,1e4);return()=>clearInterval(m)},[]);const l=u.useMemo(()=>{const a=n.filter(x=>x.severity==="critical").length,m=n.filter(x=>x.severity==="warning").length;return{totalEvents:i,eventsPerSecond:d,criticalAnomalies:a,warningAnomalies:m,totalAnomalies:n.length,avgBetti:Math.round((r.h0+r.h1+r.h2)/3),threatScore:Math.floor(50+Math.random()*30)}},[i,d,n,r]),t=[{title:"Total Events Processed",value:l.totalEvents.toLocaleString(),change:"+12.5%",trend:"up",icon:F,color:"text-primary",bgColor:"bg-primary/10"},{title:"Current Throughput",value:`${l.eventsPerSecond}/s`,change:s?"Live":"Paused",trend:s?"up":"stable",icon:H,color:"text-success",bgColor:"bg-success/10"},{title:"Anomalies Detected",value:l.totalAnomalies.toString(),change:`${l.criticalAnomalies} critical`,trend:l.criticalAnomalies>0?"down":"stable",icon:w,color:"text-anomaly",bgColor:"bg-anomaly/10"},{title:"Threat Intelligence Score",value:l.threatScore.toString(),change:"Real-time",trend:"stable",icon:N,color:"text-info",bgColor:"bg-info/10"}];return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(Y,{}),e.jsxs("main",{className:"pt-20 pb-8 px-4 sm:px-6 lg:px-8 max-w-[1600px] mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsxs(o.h1,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(O,{className:"w-6 h-6 text-primary"}),"Advanced Analytics"]}),e.jsx(o.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.1},className:"text-sm text-muted-foreground mt-1",children:"Comprehensive threat intelligence and performance metrics"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-slate-800/50 p-1 rounded-lg border border-slate-700/50",children:[e.jsx(j,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs hover:bg-slate-700",children:"1h"}),e.jsx(j,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs bg-slate-700 text-white shadow-sm",children:"24h"}),e.jsx(j,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs hover:bg-slate-700",children:"7d"}),e.jsx(j,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs hover:bg-slate-700",children:"30d"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground bg-slate-800/30 px-3 py-1.5 rounded-md border border-slate-700/30",children:[e.jsx(K,{className:"w-4 h-4"}),e.jsx("span",{children:new Date().toLocaleDateString()})]})]})]}),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:t.map((a,m)=>e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:m*.1},children:e.jsx(f,{variant:"glass",className:"h-full",children:e.jsxs(v,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${a.bgColor}`,children:e.jsx(a.icon,{className:`w-5 h-5 ${a.color}`})}),e.jsxs("div",{className:`flex items-center gap-1 text-xs ${a.trend==="up"?"text-success":a.trend==="down"?"text-critical":"text-muted-foreground"}`,children:[a.trend==="up"&&e.jsx(T,{className:"w-3 h-3"}),a.trend==="down"&&e.jsx(W,{className:"w-3 h-3"}),e.jsx("span",{children:a.change})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wider mb-1",children:a.title}),e.jsx("p",{className:"text-2xl font-bold font-mono",children:a.value})]})})},a.title))}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6 mb-6",children:[e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:e.jsx(q,{})}),e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:e.jsx(Q,{})})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6 mb-6",children:[e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},children:e.jsxs(f,{children:[e.jsx(y,{children:e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(N,{className:"w-5 h-5"}),"Live Threat Intelligence"]})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-3 max-h-[500px] overflow-y-auto",children:[c.map((a,m)=>e.jsx(X,{threat:a,index:m},a.id)),c.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(N,{className:"w-12 h-12 mx-auto mb-2 opacity-20"}),e.jsx("p",{className:"text-sm",children:"No threats detected"})]})]})})]})}),e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7},children:e.jsx(V,{})})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6 mb-6",children:[e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},children:e.jsx(ee,{})}),e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9},children:e.jsx(_,{})})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1},children:e.jsxs(f,{variant:"glass",children:[e.jsx(y,{children:e.jsx(b,{className:"text-sm font-medium",children:"Betti Number Distribution"})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-topo-h0",children:"β₀ (Components)"}),e.jsx("span",{className:"font-mono font-semibold",children:r.h0})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:e.jsx(o.div,{className:"bg-topo-h0 h-2 rounded-full",initial:{width:0},animate:{width:`${Math.min(r.h0*2,100)}%`}})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-topo-h1",children:"β₁ (Loops)"}),e.jsx("span",{className:"font-mono font-semibold",children:r.h1})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:e.jsx(o.div,{className:"bg-topo-h1 h-2 rounded-full",initial:{width:0},animate:{width:`${Math.min(r.h1*3,100)}%`}})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-topo-h2",children:"β₂ (Voids)"}),e.jsx("span",{className:"font-mono font-semibold",children:r.h2})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:e.jsx(o.div,{className:"bg-topo-h2 h-2 rounded-full",initial:{width:0},animate:{width:`${Math.min(r.h2*10,100)}%`}})})]})})]})}),e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.1},children:e.jsxs(f,{variant:"glass",children:[e.jsx(y,{children:e.jsx(b,{className:"text-sm font-medium",children:"Anomaly Breakdown"})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-critical/10 border border-critical/20",children:[e.jsx("span",{className:"text-sm text-critical",children:"Critical"}),e.jsx(p,{variant:"critical",children:l.criticalAnomalies})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-anomaly/10 border border-anomaly/20",children:[e.jsx("span",{className:"text-sm text-anomaly",children:"Warning"}),e.jsx(p,{variant:"anomaly",children:l.warningAnomalies})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-info/10 border border-info/20",children:[e.jsx("span",{className:"text-sm text-info",children:"Info"}),e.jsx(p,{variant:"info",children:n.filter(a=>a.severity==="info").length})]})]})})]})}),e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.2},children:e.jsxs(f,{variant:"glass",children:[e.jsx(y,{children:e.jsxs(b,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4"}),"Data Sources Active"]})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Wikipedia"}),e.jsx(p,{variant:s?"success":"outline",children:s?"Live":"Off"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Kaspersky"}),e.jsx(p,{variant:"success",children:"Live"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Bitdefender"}),e.jsx(p,{variant:"success",children:"Live"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"ANY.RUN"}),e.jsx(p,{variant:"success",children:"Live"})]}),e.jsx("div",{className:"text-xs text-muted-foreground pt-2 border-t",children:"Total: 4 active streams"})]})})]})})]})]})]})};export{me as default};
