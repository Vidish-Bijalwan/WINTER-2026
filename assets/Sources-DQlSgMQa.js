import{r,j as e,o as S,v as w,as as O,S as z,a_ as W,a$ as _,b0 as Q,G as D,b1 as U,b2 as q,b3 as H,s as J,b4 as K,b5 as V,b6 as X,b7 as Y,b8 as Z}from"./vendor-DGrUDQ2I.js";import{N as ee}from"./Navigation-BVPs7ItV.js";import{C as ae,d as se}from"./card-B7dcnbPq.js";import{D as te,a as re,b as oe,c as ie,d as le,f as ne,B as h}from"./dialog-wlQmAJLT.js";import{B as n}from"./button-CASUhqHA.js";import{u as ce,a as de}from"./index-CPX5yCap.js";import{A as b}from"./api-DnZfAAQS.js";import{I as c}from"./input-C0IK7XCG.js";import{L as p}from"./label-4mnba5In.js";const je=()=>{const{isConnected:o,connect:k,disconnect:E,eventsPerSecond:v,totalEventsProcessed:f}=ce(),{toast:d}=de(),[j,N]=r.useState([]),[A,y]=r.useState(!1),[s,i]=r.useState({name:"",url:"",type:"Custom",description:""}),[x,F]=r.useState("All"),[g,M]=r.useState(""),C=[{id:"wikipedia",name:"Wikipedia Recent Changes",description:"Real-time SSE stream of all Wikipedia edits across all languages",type:"Social Media",protocol:"SSE",icon:D,url:"stream.wikimedia.org",eventsPerSecond:o?v:0,totalEvents:o?f:0,color:"text-blue-500",bgColor:"bg-blue-500/10",active:o}],L=a=>({"Social Media":Z,"News & Media":Y,Development:X,Environmental:V,Geographic:D,Finance:K,Cybersecurity:J,Gaming:H,Culture:q,Government:U})[a]||w,T=a=>({"Social Media":{color:"text-blue-500",bgColor:"bg-blue-500/10"},"News & Media":{color:"text-orange-500",bgColor:"bg-orange-500/10"},Development:{color:"text-purple-500",bgColor:"bg-purple-500/10"},Environmental:{color:"text-green-500",bgColor:"bg-green-500/10"},Geographic:{color:"text-cyan-500",bgColor:"bg-cyan-500/10"},Finance:{color:"text-yellow-500",bgColor:"bg-yellow-500/10"},Cybersecurity:{color:"text-red-500",bgColor:"bg-red-500/10"},Gaming:{color:"text-pink-500",bgColor:"bg-pink-500/10"},Culture:{color:"text-indigo-500",bgColor:"bg-indigo-500/10"},Government:{color:"text-slate-500",bgColor:"bg-slate-500/10"}})[a]||{color:"text-gray-500",bgColor:"bg-gray-500/10"},u=async()=>{try{const a=await fetch(`${b}/api/sources/`);if(a.ok){const l=(await a.json()).map(m=>{const B=T(m.type);return{...m,icon:L(m.type),protocol:m.protocol||"REST",eventsPerSecond:0,totalEvents:0,...B}});N([...C,...l])}}catch(a){console.error("Failed to fetch sources:",a),N(C)}};r.useEffect(()=>{u()},[o,v,f]);const G=async()=>{try{(await fetch(`${b}/api/sources/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok?(d({title:"Source Added",description:"New data source configured successfully."}),y(!1),i({name:"",url:"",type:"Custom",description:""}),u()):d({title:"Error",description:"Failed to add source.",variant:"destructive"})}catch{d({title:"Error",description:"Network error.",variant:"destructive"})}},P=async a=>{if(a!=="wikipedia")try{(await fetch(`${b}/api/sources/${a}`,{method:"DELETE"})).ok&&(d({title:"Source Deleted",description:"Data source removed."}),u())}catch(t){console.error("Delete failed",t)}},I=a=>{a==="wikipedia"&&(o?E():k())},$=["All",...Array.from(new Set(j.map(a=>a.type)))],R=j.filter(a=>{const t=x==="All"||a.type===x,l=a.name.toLowerCase().includes(g.toLowerCase())||a.description.toLowerCase().includes(g.toLowerCase());return t&&l});return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(ee,{}),e.jsxs("main",{className:"pt-20 pb-8 px-4 sm:px-6 lg:px-8 max-w-[1400px] mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsxs(S.h1,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(w,{className:"w-6 h-6 text-primary"}),"Data Sources"]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Manage your real-time data stream connections"})]}),e.jsxs(te,{open:A,onOpenChange:y,children:[e.jsx(re,{asChild:!0,children:e.jsxs(n,{variant:"default",size:"sm",className:"gap-2",children:[e.jsx(O,{className:"w-4 h-4"}),"Add Custom Source"]})}),e.jsxs(oe,{className:"bg-slate-900 border-slate-800 text-slate-100",children:[e.jsx(ie,{children:e.jsx(le,{children:"Add New Data Source"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"name",children:"Name"}),e.jsx(c,{id:"name",value:s.name,onChange:a=>i({...s,name:a.target.value}),className:"bg-slate-800 border-slate-700"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"url",children:"URL / Endpoint"}),e.jsx(c,{id:"url",value:s.url,onChange:a=>i({...s,url:a.target.value}),className:"bg-slate-800 border-slate-700"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"type",children:"Type"}),e.jsx(c,{id:"type",value:s.type,onChange:a=>i({...s,type:a.target.value}),className:"bg-slate-800 border-slate-700"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"desc",children:"Description"}),e.jsx(c,{id:"desc",value:s.description,onChange:a=>i({...s,description:a.target.value}),className:"bg-slate-800 border-slate-700"})]})]}),e.jsx(ne,{children:e.jsx(n,{onClick:G,children:"Add Source"})})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(c,{placeholder:"Search sources...",value:g,onChange:a=>M(a.target.value),className:"pl-10"})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:$.map(a=>e.jsxs(n,{variant:x===a?"default":"outline",size:"sm",onClick:()=>F(a),className:"whitespace-nowrap",children:[a==="All"&&e.jsx(W,{className:"w-3 h-3 mr-1"}),a]},a))})]}),e.jsx("div",{className:"grid gap-4",children:R.map((a,t)=>{const l=a.icon;return e.jsx(S.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:t*.05},children:e.jsx(ae,{className:"overflow-hidden hover:border-primary/30 transition-all group",children:e.jsx(se,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${a.active?a.bgColor:"bg-muted"} transition-colors`,children:e.jsx(l,{className:`w-6 h-6 ${a.active?a.color:"text-muted-foreground"}`})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold",children:a.name}),a.active?e.jsx(h,{variant:"success",className:"animate-pulse",children:"Live"}):e.jsx(h,{variant:"outline",children:"Inactive"}),e.jsx(h,{variant:"secondary",className:"text-[10px]",children:a.type})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:a.description}),e.jsx("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:e.jsx("span",{className:"font-mono",children:a.url})})]}),e.jsx("div",{className:"flex items-center gap-2",children:a.id==="wikipedia"?e.jsxs(n,{variant:a.active?"outline":"default",size:"sm",onClick:()=>I(a.id),children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),a.active?"Disconnect":"Connect"]}):e.jsx(n,{variant:"ghost",size:"icon",onClick:()=>P(a.id),className:"text-red-500 hover:text-red-400 hover:bg-red-500/10",children:e.jsx(Q,{className:"w-4 h-4"})})})]})})})},a.id)})})]})]})};export{je as default};
