import{r as g,j as e,o as c,s as M,b0 as U,aZ as D,F as E,aL as G,b1 as F,b2 as H,b3 as O,b4 as K,ay as W,aG as Z,aH as V,aA as Y,aB as J,aC as X,aD as _,aI as I,aU as P,aa as q,b5 as Q,H as ee,X as te,Z as se,g as ae,f as ie,a8 as re,b6 as ne,v as le}from"./vendor-BJtIU4cE.js";import{N as de}from"./Navigation-CchaNxGk.js";import{C as b,a as w,b as k,c as S,d as N}from"./card-CjP5KoZO.js";import{B as v}from"./dialog-B7IIvyeJ.js";import{B as p}from"./button-ZZWTDpQH.js";import{u as L,c as ce}from"./index-DT2D_i0V.js";import{S as oe}from"./slider-CvQLdGqS.js";import{a as me}from"./ThreatIntelCard-uScfWQHb.js";function xe({className:s}){const{riskHeatmap:d,isConnected:n}=L(),{gridData:r,labels:t}=g.useMemo(()=>d.grid.length>0?{gridData:d.grid,labels:d.labels}:{gridData:[[.1,.1,.1,.1,.1,.1,.1],[.1,.1,.1,.1,.1,.1,.1],[.1,.1,.1,.1,.1,.1,.1],[.1,.1,.1,.1,.1,.1,.1],[.1,.1,.1,.1,.1,.1,.1],[.1,.1,.1,.1,.1,.1,.1]],labels:{x:["EN","DE","FR","ES","JA","ZH","COM"],y:["Main","Talk","User","Wiki","File","Template"]}},[d]),o=l=>l>=.8?"hsl(var(--critical))":l>=.6?"hsl(var(--anomaly))":l>=.4?"hsl(var(--info))":"hsl(var(--primary) / 0.3)",m=l=>.3+l*.7;return e.jsxs("div",{className:ce("relative bg-card/50 rounded-xl p-4 border border-border/50",s),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Risk Heatmap"}),e.jsx("span",{className:"text-[10px] text-muted-foreground",children:"Wiki × Namespace"}),n&&e.jsx(c.div,{className:"w-1.5 h-1.5 rounded-full bg-success",animate:{opacity:[.5,1,.5]},transition:{duration:2,repeat:1/0}})]}),e.jsxs("div",{className:"flex gap-2 text-[9px]",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-primary/30"}),e.jsx("span",{className:"text-muted-foreground",children:"Low"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-info"}),e.jsx("span",{className:"text-muted-foreground",children:"Med"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-anomaly"}),e.jsx("span",{className:"text-muted-foreground",children:"High"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-critical"}),e.jsx("span",{className:"text-muted-foreground",children:"Critical"})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex flex-col gap-1 pt-5",children:t.y.map(l=>e.jsx("div",{className:"h-8 flex items-center text-[10px] text-muted-foreground",children:l},l))}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex gap-1 mb-1",children:t.x.map(l=>e.jsx("div",{className:"flex-1 text-center text-[10px] text-muted-foreground",children:l},l))}),e.jsx("div",{className:"space-y-1",children:r.map((l,a)=>e.jsx("div",{className:"flex gap-1",children:l.map((i,u)=>e.jsx(c.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:(a*l.length+u)*.01},className:"flex-1 h-8 rounded cursor-pointer transition-transform hover:scale-105 relative",style:{backgroundColor:o(i),opacity:m(i)},title:`${t.y[a]} × ${t.x[u]}: ${(i*100).toFixed(0)}% risk`,children:i>=.8&&e.jsx(c.div,{className:"absolute inset-0 rounded",animate:{opacity:[.5,1,.5]},transition:{duration:1.5,repeat:1/0},style:{backgroundColor:"hsl(var(--critical) / 0.3)"}})},`${a}-${u}`))},a))})]})]}),!n&&e.jsx("p",{className:"text-[10px] text-muted-foreground mt-3 text-center",children:"Connect to Wikipedia stream to see live risk distribution"})]})}function he(){const[s,d]=g.useState([]);g.useEffect(()=>{const r=[{ip:"192.168.45.123",reputation:"malicious",score:95,country:"RU",firstSeen:new Date(Date.now()-6048e5),lastSeen:new Date,threatCount:45,tags:["botnet","c2","malware"]},{ip:"45.142.34.98",reputation:"suspicious",score:68,country:"CN",firstSeen:new Date(Date.now()-2592e5),lastSeen:new Date(Date.now()-36e5),threatCount:12,tags:["scanning","reconnaissance"]},{ip:"203.45.67.89",reputation:"clean",score:15,country:"US",firstSeen:new Date(Date.now()-2592e6),lastSeen:new Date(Date.now()-864e5),threatCount:0,tags:["cdn","legitimate"]}];d(r)},[]);const n={malicious:"bg-red-500/10 text-red-500 border-red-500/30",suspicious:"bg-orange-500/10 text-orange-500 border-orange-500/30",clean:"bg-green-500/10 text-green-500 border-green-500/30",unknown:"bg-gray-500/10 text-gray-500 border-gray-500/30"};return e.jsxs(b,{children:[e.jsx(w,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(k,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5"}),"IP Reputation Tracker"]}),e.jsx(S,{children:"Real-time threat intelligence for monitored IPs"})]}),e.jsx(p,{size:"sm",variant:"outline",children:"Add IP"})]})}),e.jsx(N,{children:e.jsx("div",{className:"space-y-3",children:s.map((r,t)=>e.jsxs(c.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:t*.1},className:"p-4 border border-border/50 rounded-lg hover:border-primary/30 transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("code",{className:"text-sm font-mono font-semibold",children:r.ip}),e.jsx(v,{variant:"outline",className:n[r.reputation],children:r.reputation})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(U,{className:"w-3 h-3"}),r.country]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(D,{className:"w-3 h-3"}),r.threatCount," threats"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold text-primary",children:r.score}),e.jsx("div",{className:"text-[10px] text-muted-foreground",children:"threat score"})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("div",{className:"flex gap-1",children:r.tags.map((o,m)=>e.jsx(v,{variant:"secondary",className:"text-[9px]",children:o},m))}),e.jsxs("div",{className:"text-muted-foreground",children:["Last seen: ",r.lastSeen.toLocaleTimeString()]})]}),e.jsx("div",{className:"mt-2 h-1 bg-muted rounded-full overflow-hidden",children:e.jsx(c.div,{initial:{width:0},animate:{width:`${r.score}%`},className:`h-full ${r.score>80?"bg-red-500":r.score>50?"bg-orange-500":"bg-green-500"}`})})]},r.ip))})})]})}function ue(){const[s,d]=g.useState("24h"),[n,r]=g.useState([]),[t,o]=g.useState(!1),[m,l]=g.useState(-1),a=g.useRef(null);g.useEffect(()=>{const y=(()=>{const $=s==="1h"?12:s==="24h"?24:s==="7d"?14:30;return Array.from({length:$},(C,j)=>({time:s==="1h"?`${String(j*5).padStart(2,"0")}m`:s==="24h"?`${String(j).padStart(2,"0")}:00`:s==="7d"?`Day ${j+1}`:`Day ${j+1}`,threats:Math.floor(Math.random()*50)+10,anomalies:Math.floor(Math.random()*20)+5,normalEvents:Math.floor(Math.random()*100)+50}))})();r(y),l(y.length-1),o(!1)},[s]),g.useEffect(()=>(t?a.current=setInterval(()=>{l(x=>x>=n.length-1?(o(!1),x):x+1)},500):a.current&&clearInterval(a.current),()=>{a.current&&clearInterval(a.current)}),[t,n.length]);const i=()=>{m>=n.length-1&&l(0),o(!t)},u=x=>{l(x[0]),o(!1)},f=()=>{const x=[["Time","Threats","Anomalies","Normal Events"],...n.map(j=>[j.time,j.threats,j.anomalies,j.normalEvents])].map(j=>j.join(",")).join(`
`),y=new Blob([x],{type:"text/csv"}),$=URL.createObjectURL(y),C=document.createElement("a");C.href=$,C.download=`threat-trends-${s}-${Date.now()}.csv`,C.click()},h=n.slice(0,m+1),R=h.reduce((x,y)=>x+y.threats,0),z=h.length>0?Math.round(R/h.length):0,B=h[h.length-1],T=h[0],A=h.length>1&&T.threats>0?(B.threats-T.threats)/T.threats*100:0;return e.jsxs(b,{children:[e.jsx(w,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(k,{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-5 h-5"}),"Historical Trends"]}),e.jsxs(S,{children:["Threat activity over time",m<n.length-1&&e.jsx("span",{className:"text-amber-500 ml-2",children:"(Playback Mode)"})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(p,{size:"sm",variant:"outline",onClick:f,children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Export"]})})]})}),e.jsxs(N,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("div",{className:"flex gap-2",children:["1h","24h","7d","30d"].map(x=>e.jsx(p,{size:"sm",variant:s===x?"default":"outline",onClick:()=>d(x),children:x},x))}),e.jsxs("div",{className:"flex items-center gap-2 bg-slate-100 dark:bg-slate-800 p-1 rounded-lg",children:[e.jsx(p,{size:"icon",variant:"ghost",className:"h-8 w-8",onClick:()=>l(0),disabled:m===0,children:e.jsx(F,{className:"w-4 h-4"})}),e.jsx(p,{size:"icon",variant:t?"destructive":"default",className:"h-8 w-8",onClick:i,children:t?e.jsx(H,{className:"w-4 h-4"}):e.jsx(O,{className:"w-4 h-4"})}),e.jsx(p,{size:"icon",variant:"ghost",className:"h-8 w-8",onClick:()=>l(n.length-1),disabled:m>=n.length-1,children:e.jsx(K,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"mb-6 px-2",children:[e.jsx(oe,{value:[m],max:n.length-1,step:1,onValueChange:u,className:"my-4"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"Start"}),e.jsx("span",{children:h.length>0?h[h.length-1].time:""}),e.jsx("span",{children:"End"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs(c.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"p-3 bg-card border border-border/50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-500",children:R}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Threats (Visible)"})]}),e.jsxs(c.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"p-3 bg-card border border-border/50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:z}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Avg per Period"})]}),e.jsxs(c.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"p-3 bg-card border border-border/50 rounded-lg",children:[e.jsxs("div",{className:`text-2xl font-bold ${A>0?"text-red-500":"text-green-500"}`,children:[A>0?"+":"",A.toFixed(1),"%"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Trend"})]})]}),e.jsx(W,{width:"100%",height:250,children:e.jsxs(Z,{data:n,children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"threatsGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#ef4444",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#ef4444",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"anomaliesGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#f59e0b",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#f59e0b",stopOpacity:0})]})]}),e.jsx(V,{strokeDasharray:"3 3",stroke:"hsl(var(--border))"}),e.jsx(Y,{dataKey:"time",stroke:"hsl(var(--muted-foreground))",style:{fontSize:"10px"}}),e.jsx(J,{stroke:"hsl(var(--muted-foreground))",style:{fontSize:"10px"}}),e.jsx(X,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"8px"}}),e.jsx(_,{x:h.length>0?h[h.length-1].time:"",stroke:"hsl(var(--primary))",strokeDasharray:"3 3"}),e.jsx(I,{type:"monotone",dataKey:"threats",stroke:"#ef4444",fillOpacity:1,fill:"url(#threatsGradient)",data:n.map((x,y)=>y<=m?x:{...x,threats:null,anomalies:null}),connectNulls:!1}),e.jsx(I,{type:"monotone",dataKey:"anomalies",stroke:"#f59e0b",fillOpacity:1,fill:"url(#anomaliesGradient)",data:n.map((x,y)=>y<=m?x:{...x,threats:null,anomalies:null}),connectNulls:!1})]})})]})]})}function ge(){const[s,d]=g.useState([]);g.useEffect(()=>{d([{country:"Russia",code:"RU",lat:55.7558,lng:37.6173,threats:245,severity:"critical"},{country:"China",code:"CN",lat:39.9042,lng:116.4074,threats:189,severity:"high"},{country:"United States",code:"US",lat:38.9072,lng:-77.0369,threats:156,severity:"high"},{country:"Brazil",code:"BR",lat:-15.7975,lng:-47.8919,threats:98,severity:"medium"},{country:"India",code:"IN",lat:28.6139,lng:77.209,threats:87,severity:"medium"},{country:"Germany",code:"DE",lat:52.52,lng:13.405,threats:45,severity:"low"}])},[]);const n={critical:"bg-red-500",high:"bg-orange-500",medium:"bg-yellow-500",low:"bg-blue-500"},r=Math.max(...s.map(t=>t.threats));return e.jsxs(b,{children:[e.jsxs(w,{children:[e.jsxs(k,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-5 h-5"}),"Global Threat Map"]}),e.jsx(S,{children:"Geographic distribution of threat activity"})]}),e.jsxs(N,{children:[e.jsxs("div",{className:"relative w-full h-64 bg-muted/30 rounded-lg overflow-hidden mb-4",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 to-transparent"}),s.map((t,o)=>{const m=20+t.threats/r*40,l=(t.lng+180)/360*100,a=(90-t.lat)/180*100;return e.jsx(c.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{delay:o*.1},className:"absolute",style:{left:`${l}%`,top:`${a}%`,transform:"translate(-50%, -50%)"},children:e.jsxs("div",{className:"relative group",children:[e.jsx(c.div,{animate:{scale:[1,1.2,1],opacity:[.5,.8,.5]},transition:{duration:2,repeat:1/0,delay:o*.2},className:`w-${Math.floor(m/4)} h-${Math.floor(m/4)} ${n[t.severity]} rounded-full blur-md`,style:{width:m,height:m}}),e.jsx("div",{className:`absolute inset-0 ${n[t.severity]} rounded-full`,style:{width:m*.5,height:m*.5,left:"25%",top:"25%"}}),e.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 hidden group-hover:block z-10",children:e.jsxs("div",{className:"bg-card border border-border shadow-lg rounded-lg p-2 whitespace-nowrap",children:[e.jsx("div",{className:"text-xs font-semibold",children:t.country}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[t.threats," threats"]}),e.jsx(v,{variant:"outline",className:"text-[9px] mt-1",children:t.severity})]})})]})},t.code)})]}),e.jsx("div",{className:"space-y-2",children:s.sort((t,o)=>o.threats-t.threats).map((t,o)=>e.jsxs(c.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:o*.05},className:"flex items-center justify-between p-2 bg-muted/30 rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 ${n[t.severity]} rounded-full`}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:t.country}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[t.lat.toFixed(2),"°, ",t.lng.toFixed(2),"°"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold",children:t.threats}),e.jsx("div",{className:"text-[10px] text-muted-foreground",children:"threats"})]})]},t.code))}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-border/50 grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold text-primary",children:s.length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Countries"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold text-red-500",children:s.reduce((t,o)=>t+o.threats,0)}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Threats"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold text-orange-500",children:s.filter(t=>t.severity==="critical"||t.severity==="high").length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"High Risk"})]})]})]})]})}function pe(){const[s,d]=g.useState([{id:"1",timestamp:new Date(Date.now()-3e5),title:"Critical: Ransomware Detected",message:"WannaCry variant detected on 5 endpoints",severity:"critical",read:!1,acknowledged:!1},{id:"2",timestamp:new Date(Date.now()-6e5),title:"Suspicious Network Activity",message:"Unusual outbound traffic to unknown IP 45.142.34.98",severity:"warning",read:!1,acknowledged:!1},{id:"3",timestamp:new Date(Date.now()-12e5),title:"System Update Available",message:"New threat signatures available for download",severity:"info",read:!0,acknowledged:!0}]),n=a=>{d(s.map(i=>i.id===a?{...i,acknowledged:!0,read:!0}:i))},r=a=>{d(s.filter(i=>i.id!==a))},t=a=>{d(s.map(i=>i.id===a?{...i,read:!0}:i))},o={critical:{icon:D,color:"text-red-500",bg:"bg-red-500/10",border:"border-red-500/30"},warning:{icon:D,color:"text-orange-500",bg:"bg-orange-500/10",border:"border-orange-500/30"},info:{icon:Q,color:"text-blue-500",bg:"bg-blue-500/10",border:"border-blue-500/30"}},m=s.filter(a=>!a.read).length,l=s.filter(a=>!a.acknowledged).length;return e.jsxs(b,{children:[e.jsx(w,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(k,{className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5"}),"Alert Management",m>0&&e.jsxs(v,{variant:"destructive",className:"text-xs",children:[m," new"]})]}),e.jsx(S,{children:"Real-time security alerts and notifications"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(p,{size:"sm",variant:"outline",onClick:()=>d(s.map(a=>({...a,read:!0}))),children:"Mark All Read"})})]})}),e.jsxs(N,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[e.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-500",children:s.filter(a=>a.severity==="critical").length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Critical"})]}),e.jsxs("div",{className:"p-3 bg-orange-500/10 border border-orange-500/30 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-500",children:s.filter(a=>a.severity==="warning").length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Warning"})]}),e.jsxs("div",{className:"p-3 bg-blue-500/10 border border-blue-500/30 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-500",children:l}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Pending"})]})]}),e.jsx("div",{className:"space-y-2",children:e.jsx(q,{children:s.map((a,i)=>{const u=o[a.severity],f=u.icon;return e.jsx(c.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20,height:0},transition:{delay:i*.05},className:`p-4 border ${u.border} ${u.bg} rounded-lg ${a.read?"":"font-semibold"}`,onClick:()=>!a.read&&t(a.id),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(f,{className:`w-5 h-5 ${u.color} mt-0.5 shrink-0`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[e.jsx("h4",{className:"text-sm font-medium",children:a.title}),!a.read&&e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full shrink-0 mt-1.5"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:a.message}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-[10px] text-muted-foreground",children:a.timestamp.toLocaleTimeString()}),e.jsxs("div",{className:"flex gap-2",children:[!a.acknowledged&&e.jsxs(p,{size:"sm",variant:"ghost",className:"h-7 text-xs",onClick:h=>{h.stopPropagation(),n(a.id)},children:[e.jsx(ee,{className:"w-3 h-3 mr-1"}),"Acknowledge"]}),e.jsxs(p,{size:"sm",variant:"ghost",className:"h-7 text-xs",onClick:h=>{h.stopPropagation(),r(a.id)},children:[e.jsx(te,{className:"w-3 h-3 mr-1"}),"Dismiss"]})]})]})]})]})},a.id)})})}),s.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(P,{className:"w-12 h-12 mx-auto mb-2 opacity-20"}),e.jsx("p",{className:"text-sm",children:"No alerts at this time"})]})]})]})}function fe(){const s=["malware","phishing","intrusion","vulnerability"],d=["critical","high","medium","low"],n=["RU","CN","US","BR","IN","KR","DE","FR","GB","JP"],r=s[Math.floor(Math.random()*s.length)],t=d[Math.floor(Math.random()*d.length)],o=()=>`${Math.floor(Math.random()*256)}.${Math.floor(Math.random()*256)}.${Math.floor(Math.random()*256)}.${Math.floor(Math.random()*256)}`;return{id:crypto.randomUUID(),timestamp:new Date,source:"Kaspersky Threat Intelligence",threatType:r,severity:t,indicator:o(),indicatorType:"ip",confidence:70+Math.random()*30,country:n[Math.floor(Math.random()*n.length)],description:`${r.toUpperCase()} activity detected via Kaspersky Global Threat Network`,tags:["kaspersky",r,t,"apt"]}}function je(){const s=["zeus","emotet","trickbot","ryuk","wannacry","locky"],d=s[Math.floor(Math.random()*s.length)],n=()=>`malicious-${Math.random().toString(36).substr(2,8)}.com`;return{id:crypto.randomUUID(),timestamp:new Date,source:"Bitdefender Threat Intel",threatType:"malware",severity:Math.random()>.7?"critical":"high",indicator:n(),indicatorType:"domain",confidence:80+Math.random()*20,description:`${d.toUpperCase()} malware family detected by GravityZone`,tags:["bitdefender","malware",d,"c2"]}}function ve(){const s=["file-encryption","registry-modification","network-scan","credential-theft"],d=s[Math.floor(Math.random()*s.length)],n=()=>Array.from({length:64},()=>Math.floor(Math.random()*16).toString(16)).join("");return{id:crypto.randomUUID(),timestamp:new Date,source:"ANY.RUN Sandbox",threatType:"malware",severity:d==="file-encryption"?"critical":"high",indicator:n(),indicatorType:"hash",confidence:90+Math.random()*10,description:`Behavioral analysis: ${d} detected in sandbox environment`,tags:["anyrun","sandbox",d,"dynamic-analysis"]}}const Se=()=>{const{totalEventsProcessed:s,eventsPerSecond:d,anomalies:n,bettiNumbers:r,isConnected:t}=L(),[o,m]=g.useState([]);g.useEffect(()=>{const i=()=>{const f=[];for(let h=0;h<3;h++)Math.random()>.5&&f.push(fe()),Math.random()>.5&&f.push(je()),Math.random()>.7&&f.push(ve());m(f.slice(0,6))};i();const u=setInterval(i,1e4);return()=>clearInterval(u)},[]);const l=g.useMemo(()=>{const i=n.filter(f=>f.severity==="critical").length,u=n.filter(f=>f.severity==="warning").length;return{totalEvents:s,eventsPerSecond:d,criticalAnomalies:i,warningAnomalies:u,totalAnomalies:n.length,avgBetti:Math.round((r.h0+r.h1+r.h2)/3),threatScore:Math.floor(50+Math.random()*30)}},[s,d,n,r]),a=[{title:"Total Events Processed",value:l.totalEvents.toLocaleString(),change:"+12.5%",trend:"up",icon:se,color:"text-primary",bgColor:"bg-primary/10"},{title:"Current Throughput",value:`${l.eventsPerSecond}/s`,change:t?"Live":"Paused",trend:t?"up":"stable",icon:ae,color:"text-success",bgColor:"bg-success/10"},{title:"Anomalies Detected",value:l.totalAnomalies.toString(),change:`${l.criticalAnomalies} critical`,trend:l.criticalAnomalies>0?"down":"stable",icon:D,color:"text-anomaly",bgColor:"bg-anomaly/10"},{title:"Threat Intelligence Score",value:l.threatScore.toString(),change:"Real-time",trend:"stable",icon:M,color:"text-info",bgColor:"bg-info/10"}];return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(de,{}),e.jsxs("main",{className:"pt-20 pb-8 px-4 sm:px-6 lg:px-8 max-w-[1600px] mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsxs(c.h1,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(ie,{className:"w-6 h-6 text-primary"}),"Advanced Analytics"]}),e.jsx(c.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.1},className:"text-sm text-muted-foreground mt-1",children:"Comprehensive threat intelligence and performance metrics"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-slate-800/50 p-1 rounded-lg border border-slate-700/50",children:[e.jsx(p,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs hover:bg-slate-700",children:"1h"}),e.jsx(p,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs bg-slate-700 text-white shadow-sm",children:"24h"}),e.jsx(p,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs hover:bg-slate-700",children:"7d"}),e.jsx(p,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs hover:bg-slate-700",children:"30d"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground bg-slate-800/30 px-3 py-1.5 rounded-md border border-slate-700/30",children:[e.jsx(re,{className:"w-4 h-4"}),e.jsx("span",{children:new Date().toLocaleDateString()})]})]})]}),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:a.map((i,u)=>e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:u*.1},children:e.jsx(b,{variant:"glass",className:"h-full",children:e.jsxs(N,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${i.bgColor}`,children:e.jsx(i.icon,{className:`w-5 h-5 ${i.color}`})}),e.jsxs("div",{className:`flex items-center gap-1 text-xs ${i.trend==="up"?"text-success":i.trend==="down"?"text-critical":"text-muted-foreground"}`,children:[i.trend==="up"&&e.jsx(E,{className:"w-3 h-3"}),i.trend==="down"&&e.jsx(ne,{className:"w-3 h-3"}),e.jsx("span",{children:i.change})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wider mb-1",children:i.title}),e.jsx("p",{className:"text-2xl font-bold font-mono",children:i.value})]})})},i.title))}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6 mb-6",children:[e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:e.jsx(ue,{})}),e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:e.jsx(ge,{})})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6 mb-6",children:[e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},children:e.jsxs(b,{children:[e.jsx(w,{children:e.jsxs(k,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5"}),"Live Threat Intelligence"]})}),e.jsx(N,{children:e.jsxs("div",{className:"space-y-3 max-h-[500px] overflow-y-auto",children:[o.map((i,u)=>e.jsx(me,{threat:i,index:u},i.id)),o.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(M,{className:"w-12 h-12 mx-auto mb-2 opacity-20"}),e.jsx("p",{className:"text-sm",children:"No threats detected"})]})]})})]})}),e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7},children:e.jsx(he,{})})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6 mb-6",children:[e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},children:e.jsx(pe,{})}),e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9},children:e.jsx(xe,{})})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1},children:e.jsxs(b,{variant:"glass",children:[e.jsx(w,{children:e.jsx(k,{className:"text-sm font-medium",children:"Betti Number Distribution"})}),e.jsx(N,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-topo-h0",children:"β₀ (Components)"}),e.jsx("span",{className:"font-mono font-semibold",children:r.h0})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:e.jsx(c.div,{className:"bg-topo-h0 h-2 rounded-full",initial:{width:0},animate:{width:`${Math.min(r.h0*2,100)}%`}})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-topo-h1",children:"β₁ (Loops)"}),e.jsx("span",{className:"font-mono font-semibold",children:r.h1})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:e.jsx(c.div,{className:"bg-topo-h1 h-2 rounded-full",initial:{width:0},animate:{width:`${Math.min(r.h1*3,100)}%`}})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-topo-h2",children:"β₂ (Voids)"}),e.jsx("span",{className:"font-mono font-semibold",children:r.h2})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:e.jsx(c.div,{className:"bg-topo-h2 h-2 rounded-full",initial:{width:0},animate:{width:`${Math.min(r.h2*10,100)}%`}})})]})})]})}),e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.1},children:e.jsxs(b,{variant:"glass",children:[e.jsx(w,{children:e.jsx(k,{className:"text-sm font-medium",children:"Anomaly Breakdown"})}),e.jsx(N,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-critical/10 border border-critical/20",children:[e.jsx("span",{className:"text-sm text-critical",children:"Critical"}),e.jsx(v,{variant:"critical",children:l.criticalAnomalies})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-anomaly/10 border border-anomaly/20",children:[e.jsx("span",{className:"text-sm text-anomaly",children:"Warning"}),e.jsx(v,{variant:"anomaly",children:l.warningAnomalies})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-info/10 border border-info/20",children:[e.jsx("span",{className:"text-sm text-info",children:"Info"}),e.jsx(v,{variant:"info",children:n.filter(i=>i.severity==="info").length})]})]})})]})}),e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.2},children:e.jsxs(b,{variant:"glass",children:[e.jsx(w,{children:e.jsxs(k,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4"}),"Data Sources Active"]})}),e.jsx(N,{children:e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Wikipedia"}),e.jsx(v,{variant:t?"success":"outline",children:t?"Live":"Off"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Kaspersky"}),e.jsx(v,{variant:"success",children:"Live"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Bitdefender"}),e.jsx(v,{variant:"success",children:"Live"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"ANY.RUN"}),e.jsx(v,{variant:"success",children:"Live"})]}),e.jsx("div",{className:"text-xs text-muted-foreground pt-2 border-t",children:"Total: 4 active streams"})]})})]})})]})]})]})};export{Se as default};
