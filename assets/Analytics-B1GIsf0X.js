import{r as g,j as e,o as m,s as T,b9 as z,aZ as A,F as B,aL as G,ba as F,bb as H,bc as O,bd as W,ay as K,aG as Z,aH as V,aA as _,aB as J,aC as X,aD as Y,aI as E,aU as U,aa as q,be as Q,H as ee,X as te,Z as se,g as ae,f as ie,a8 as re,bf as ne,v as le}from"./vendor-DGrUDQ2I.js";import{N as de}from"./Navigation-BCakuI71.js";import{C as b,a as C,b as S,c as $,d as N}from"./card-CsZyhY5H.js";import{B as w}from"./dialog-CBwJkRkz.js";import{B as p}from"./button-tSF00QVK.js";import{u as L,c as ce,d as oe,S as me}from"./index-wDoEtXv7.js";import{S as xe}from"./slider-BK2Va5Me.js";import{a as he}from"./ThreatIntelCard-ClXPmIMV.js";function ue({className:s}){const{riskHeatmap:d,isConnected:r}=L(),{gridData:i,labels:t}=g.useMemo(()=>d.grid.length>0?{gridData:d.grid,labels:d.labels}:{gridData:[[.1,.1,.1,.1,.1,.1,.1],[.1,.1,.1,.1,.1,.1,.1],[.1,.1,.1,.1,.1,.1,.1],[.1,.1,.1,.1,.1,.1,.1],[.1,.1,.1,.1,.1,.1,.1],[.1,.1,.1,.1,.1,.1,.1]],labels:{x:["EN","DE","FR","ES","JA","ZH","COM"],y:["Main","Talk","User","Wiki","File","Template"]}},[d]),x=c=>c>=.8?"hsl(var(--critical))":c>=.6?"hsl(var(--anomaly))":c>=.4?"hsl(var(--info))":"hsl(var(--primary) / 0.3)",h=c=>.3+c*.7;return e.jsxs("div",{className:ce("relative bg-card/50 rounded-xl p-4 border border-border/50",s),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Risk Heatmap"}),e.jsx("span",{className:"text-[10px] text-muted-foreground",children:"Wiki × Namespace"}),r&&e.jsx(m.div,{className:"w-1.5 h-1.5 rounded-full bg-success",animate:{opacity:[.5,1,.5]},transition:{duration:2,repeat:1/0}})]}),e.jsxs("div",{className:"flex gap-2 text-[9px]",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-primary/30"}),e.jsx("span",{className:"text-muted-foreground",children:"Low"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-info"}),e.jsx("span",{className:"text-muted-foreground",children:"Med"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-anomaly"}),e.jsx("span",{className:"text-muted-foreground",children:"High"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-critical"}),e.jsx("span",{className:"text-muted-foreground",children:"Critical"})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex flex-col gap-1 pt-5",children:t.y.map(c=>e.jsx("div",{className:"h-8 flex items-center text-[10px] text-muted-foreground",children:c},c))}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex gap-1 mb-1",children:t.x.map(c=>e.jsx("div",{className:"flex-1 text-center text-[10px] text-muted-foreground",children:c},c))}),e.jsx("div",{className:"space-y-1",children:i.map((c,a)=>e.jsx("div",{className:"flex gap-1",children:c.map((o,f)=>e.jsx(m.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:(a*c.length+f)*.01},className:"flex-1 h-8 rounded cursor-pointer transition-transform hover:scale-105 relative",style:{backgroundColor:x(o),opacity:h(o)},title:`${t.y[a]} × ${t.x[f]}: ${(o*100).toFixed(0)}% risk`,children:o>=.8&&e.jsx(m.div,{className:"absolute inset-0 rounded",animate:{opacity:[.5,1,.5]},transition:{duration:1.5,repeat:1/0},style:{backgroundColor:"hsl(var(--critical) / 0.3)"}})},`${a}-${f}`))},a))})]})]}),!r&&e.jsx("p",{className:"text-[10px] text-muted-foreground mt-3 text-center",children:"Connect to Wikipedia stream to see live risk distribution"})]})}function ge(){const[s,d]=g.useState([]);g.useEffect(()=>{const i=[{ip:"192.168.45.123",reputation:"malicious",score:95,country:"RU",firstSeen:new Date(Date.now()-6048e5),lastSeen:new Date,threatCount:45,tags:["botnet","c2","malware"]},{ip:"45.142.34.98",reputation:"suspicious",score:68,country:"CN",firstSeen:new Date(Date.now()-2592e5),lastSeen:new Date(Date.now()-36e5),threatCount:12,tags:["scanning","reconnaissance"]},{ip:"203.45.67.89",reputation:"clean",score:15,country:"US",firstSeen:new Date(Date.now()-2592e6),lastSeen:new Date(Date.now()-864e5),threatCount:0,tags:["cdn","legitimate"]}];d(i)},[]);const r={malicious:"bg-red-500/10 text-red-500 border-red-500/30",suspicious:"bg-orange-500/10 text-orange-500 border-orange-500/30",clean:"bg-green-500/10 text-green-500 border-green-500/30",unknown:"bg-gray-500/10 text-gray-500 border-gray-500/30"};return e.jsxs(b,{children:[e.jsx(C,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5"}),"IP Reputation Tracker"]}),e.jsx($,{children:"Real-time threat intelligence for monitored IPs"})]}),e.jsx(p,{size:"sm",variant:"outline",children:"Add IP"})]})}),e.jsx(N,{children:e.jsx("div",{className:"space-y-3",children:s.map((i,t)=>e.jsxs(m.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:t*.1},className:"p-4 border border-border/50 rounded-lg hover:border-primary/30 transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("code",{className:"text-sm font-mono font-semibold",children:i.ip}),e.jsx(w,{variant:"outline",className:r[i.reputation],children:i.reputation})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(z,{className:"w-3 h-3"}),i.country]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(A,{className:"w-3 h-3"}),i.threatCount," threats"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold text-primary",children:i.score}),e.jsx("div",{className:"text-[10px] text-muted-foreground",children:"threat score"})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("div",{className:"flex gap-1",children:i.tags.map((x,h)=>e.jsx(w,{variant:"secondary",className:"text-[9px]",children:x},h))}),e.jsxs("div",{className:"text-muted-foreground",children:["Last seen: ",i.lastSeen.toLocaleTimeString()]})]}),e.jsx("div",{className:"mt-2 h-1 bg-muted rounded-full overflow-hidden",children:e.jsx(m.div,{initial:{width:0},animate:{width:`${i.score}%`},className:`h-full ${i.score>80?"bg-red-500":i.score>50?"bg-orange-500":"bg-green-500"}`})})]},i.ip))})})]})}function pe(){const[s,d]=g.useState("24h"),[r,i]=g.useState([]),[t,x]=g.useState(!1),[h,c]=g.useState(-1),a=g.useRef(null);g.useEffect(()=>{const y=(()=>{const P=s==="1h"?12:s==="24h"?24:s==="7d"?14:30;return Array.from({length:P},(M,v)=>({time:s==="1h"?`${String(v*5).padStart(2,"0")}m`:s==="24h"?`${String(v).padStart(2,"0")}:00`:s==="7d"?`Day ${v+1}`:`Day ${v+1}`,threats:Math.floor(Math.random()*50)+10,anomalies:Math.floor(Math.random()*20)+5,normalEvents:Math.floor(Math.random()*100)+50}))})();i(y),c(y.length-1),x(!1)},[s]),g.useEffect(()=>(t?a.current=setInterval(()=>{c(u=>u>=r.length-1?(x(!1),u):u+1)},500):a.current&&clearInterval(a.current),()=>{a.current&&clearInterval(a.current)}),[t,r.length]);const o=()=>{h>=r.length-1&&c(0),x(!t)},f=u=>{c(u[0]),x(!1)},n=()=>{const u=[["Time","Threats","Anomalies","Normal Events"],...r.map(v=>[v.time,v.threats,v.anomalies,v.normalEvents])].map(v=>v.join(",")).join(`
`),y=new Blob([u],{type:"text/csv"}),P=URL.createObjectURL(y),M=document.createElement("a");M.href=P,M.download=`threat-trends-${s}-${Date.now()}.csv`,M.click()},l=r.slice(0,h+1),j=l.reduce((u,y)=>u+y.threats,0),D=l.length>0?Math.round(j/l.length):0,k=l[l.length-1],I=l[0],R=l.length>1&&I.threats>0?(k.threats-I.threats)/I.threats*100:0;return e.jsxs(b,{children:[e.jsx(C,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5"}),"Historical Trends"]}),e.jsxs($,{children:["Threat activity over time",h<r.length-1&&e.jsx("span",{className:"text-amber-500 ml-2",children:"(Playback Mode)"})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(p,{size:"sm",variant:"outline",onClick:n,children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Export"]})})]})}),e.jsxs(N,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("div",{className:"flex gap-2",children:["1h","24h","7d","30d"].map(u=>e.jsx(p,{size:"sm",variant:s===u?"default":"outline",onClick:()=>d(u),children:u},u))}),e.jsxs("div",{className:"flex items-center gap-2 bg-slate-100 dark:bg-slate-800 p-1 rounded-lg",children:[e.jsx(p,{size:"icon",variant:"ghost",className:"h-8 w-8",onClick:()=>c(0),disabled:h===0,children:e.jsx(F,{className:"w-4 h-4"})}),e.jsx(p,{size:"icon",variant:t?"destructive":"default",className:"h-8 w-8",onClick:o,children:t?e.jsx(H,{className:"w-4 h-4"}):e.jsx(O,{className:"w-4 h-4"})}),e.jsx(p,{size:"icon",variant:"ghost",className:"h-8 w-8",onClick:()=>c(r.length-1),disabled:h>=r.length-1,children:e.jsx(W,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"mb-6 px-2",children:[e.jsx(xe,{value:[h],max:r.length-1,step:1,onValueChange:f,className:"my-4"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"Start"}),e.jsx("span",{children:l.length>0?l[l.length-1].time:""}),e.jsx("span",{children:"End"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs(m.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"p-3 bg-card border border-border/50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-500",children:j}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Threats (Visible)"})]}),e.jsxs(m.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"p-3 bg-card border border-border/50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:D}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Avg per Period"})]}),e.jsxs(m.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"p-3 bg-card border border-border/50 rounded-lg",children:[e.jsxs("div",{className:`text-2xl font-bold ${R>0?"text-red-500":"text-green-500"}`,children:[R>0?"+":"",R.toFixed(1),"%"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Trend"})]})]}),e.jsx(K,{width:"100%",height:250,children:e.jsxs(Z,{data:r,children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"threatsGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#ef4444",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#ef4444",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"anomaliesGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#f59e0b",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#f59e0b",stopOpacity:0})]})]}),e.jsx(V,{strokeDasharray:"3 3",stroke:"hsl(var(--border))"}),e.jsx(_,{dataKey:"time",stroke:"hsl(var(--muted-foreground))",style:{fontSize:"10px"}}),e.jsx(J,{stroke:"hsl(var(--muted-foreground))",style:{fontSize:"10px"}}),e.jsx(X,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"8px"}}),e.jsx(Y,{x:l.length>0?l[l.length-1].time:"",stroke:"hsl(var(--primary))",strokeDasharray:"3 3"}),e.jsx(E,{type:"monotone",dataKey:"threats",stroke:"#ef4444",fillOpacity:1,fill:"url(#threatsGradient)",data:r.map((u,y)=>y<=h?u:{...u,threats:null,anomalies:null}),connectNulls:!1}),e.jsx(E,{type:"monotone",dataKey:"anomalies",stroke:"#f59e0b",fillOpacity:1,fill:"url(#anomaliesGradient)",data:r.map((u,y)=>y<=h?u:{...u,threats:null,anomalies:null}),connectNulls:!1})]})})]})]})}function fe(){const[s,d]=g.useState([]);g.useEffect(()=>{d([{country:"Russia",code:"RU",lat:55.7558,lng:37.6173,threats:245,severity:"critical"},{country:"China",code:"CN",lat:39.9042,lng:116.4074,threats:189,severity:"high"},{country:"United States",code:"US",lat:38.9072,lng:-77.0369,threats:156,severity:"high"},{country:"Brazil",code:"BR",lat:-15.7975,lng:-47.8919,threats:98,severity:"medium"},{country:"India",code:"IN",lat:28.6139,lng:77.209,threats:87,severity:"medium"},{country:"Germany",code:"DE",lat:52.52,lng:13.405,threats:45,severity:"low"}])},[]);const r={critical:"bg-red-500",high:"bg-orange-500",medium:"bg-yellow-500",low:"bg-blue-500"},i=Math.max(...s.map(t=>t.threats));return e.jsxs(b,{children:[e.jsxs(C,{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5"}),"Global Threat Map"]}),e.jsx($,{children:"Geographic distribution of threat activity"})]}),e.jsxs(N,{children:[e.jsxs("div",{className:"relative w-full h-64 bg-muted/30 rounded-lg overflow-hidden mb-4",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 to-transparent"}),s.map((t,x)=>{const h=20+t.threats/i*40,c=(t.lng+180)/360*100,a=(90-t.lat)/180*100;return e.jsx(m.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{delay:x*.1},className:"absolute",style:{left:`${c}%`,top:`${a}%`,transform:"translate(-50%, -50%)"},children:e.jsxs("div",{className:"relative group",children:[e.jsx(m.div,{animate:{scale:[1,1.2,1],opacity:[.5,.8,.5]},transition:{duration:2,repeat:1/0,delay:x*.2},className:`w-${Math.floor(h/4)} h-${Math.floor(h/4)} ${r[t.severity]} rounded-full blur-md`,style:{width:h,height:h}}),e.jsx("div",{className:`absolute inset-0 ${r[t.severity]} rounded-full`,style:{width:h*.5,height:h*.5,left:"25%",top:"25%"}}),e.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 hidden group-hover:block z-10",children:e.jsxs("div",{className:"bg-card border border-border shadow-lg rounded-lg p-2 whitespace-nowrap",children:[e.jsx("div",{className:"text-xs font-semibold",children:t.country}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[t.threats," threats"]}),e.jsx(w,{variant:"outline",className:"text-[9px] mt-1",children:t.severity})]})})]})},t.code)})]}),e.jsx("div",{className:"space-y-2",children:s.sort((t,x)=>x.threats-t.threats).map((t,x)=>e.jsxs(m.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:x*.05},className:"flex items-center justify-between p-2 bg-muted/30 rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 ${r[t.severity]} rounded-full`}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:t.country}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[t.lat.toFixed(2),"°, ",t.lng.toFixed(2),"°"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold",children:t.threats}),e.jsx("div",{className:"text-[10px] text-muted-foreground",children:"threats"})]})]},t.code))}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-border/50 grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold text-primary",children:s.length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Countries"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold text-red-500",children:s.reduce((t,x)=>t+x.threats,0)}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Threats"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold text-orange-500",children:s.filter(t=>t.severity==="critical"||t.severity==="high").length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"High Risk"})]})]})]})]})}function je(){const[s,d]=g.useState([{id:"1",timestamp:new Date(Date.now()-3e5),title:"Critical: Ransomware Detected",message:"WannaCry variant detected on 5 endpoints",severity:"critical",read:!1,acknowledged:!1},{id:"2",timestamp:new Date(Date.now()-6e5),title:"Suspicious Network Activity",message:"Unusual outbound traffic to unknown IP 45.142.34.98",severity:"warning",read:!1,acknowledged:!1},{id:"3",timestamp:new Date(Date.now()-12e5),title:"System Update Available",message:"New threat signatures available for download",severity:"info",read:!0,acknowledged:!0}]),r=a=>{d(s.map(o=>o.id===a?{...o,acknowledged:!0,read:!0}:o))},i=a=>{d(s.filter(o=>o.id!==a))},t=a=>{d(s.map(o=>o.id===a?{...o,read:!0}:o))},x={critical:{icon:A,color:"text-red-500",bg:"bg-red-500/10",border:"border-red-500/30"},warning:{icon:A,color:"text-orange-500",bg:"bg-orange-500/10",border:"border-orange-500/30"},info:{icon:Q,color:"text-blue-500",bg:"bg-blue-500/10",border:"border-blue-500/30"}},h=s.filter(a=>!a.read).length,c=s.filter(a=>!a.acknowledged).length;return e.jsxs(b,{children:[e.jsx(C,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-5 h-5"}),"Alert Management",h>0&&e.jsxs(w,{variant:"destructive",className:"text-xs",children:[h," new"]})]}),e.jsx($,{children:"Real-time security alerts and notifications"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(p,{size:"sm",variant:"outline",onClick:()=>d(s.map(a=>({...a,read:!0}))),children:"Mark All Read"})})]})}),e.jsxs(N,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[e.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-500",children:s.filter(a=>a.severity==="critical").length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Critical"})]}),e.jsxs("div",{className:"p-3 bg-orange-500/10 border border-orange-500/30 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-500",children:s.filter(a=>a.severity==="warning").length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Warning"})]}),e.jsxs("div",{className:"p-3 bg-blue-500/10 border border-blue-500/30 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-500",children:c}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Pending"})]})]}),e.jsx("div",{className:"space-y-2",children:e.jsx(q,{children:s.map((a,o)=>{const f=x[a.severity],n=f.icon;return e.jsx(m.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20,height:0},transition:{delay:o*.05},className:`p-4 border ${f.border} ${f.bg} rounded-lg ${a.read?"":"font-semibold"}`,onClick:()=>!a.read&&t(a.id),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(n,{className:`w-5 h-5 ${f.color} mt-0.5 shrink-0`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[e.jsx("h4",{className:"text-sm font-medium",children:a.title}),!a.read&&e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full shrink-0 mt-1.5"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:a.message}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-[10px] text-muted-foreground",children:a.timestamp.toLocaleTimeString()}),e.jsxs("div",{className:"flex gap-2",children:[!a.acknowledged&&e.jsxs(p,{size:"sm",variant:"ghost",className:"h-7 text-xs",onClick:l=>{l.stopPropagation(),r(a.id)},children:[e.jsx(ee,{className:"w-3 h-3 mr-1"}),"Acknowledge"]}),e.jsxs(p,{size:"sm",variant:"ghost",className:"h-7 text-xs",onClick:l=>{l.stopPropagation(),i(a.id)},children:[e.jsx(te,{className:"w-3 h-3 mr-1"}),"Dismiss"]})]})]})]})]})},a.id)})})}),s.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(U,{className:"w-12 h-12 mx-auto mb-2 opacity-20"}),e.jsx("p",{className:"text-sm",children:"No alerts at this time"})]})]})]})}function ve(){const s=["malware","phishing","intrusion","vulnerability"],d=["critical","high","medium","low"],r=["RU","CN","US","BR","IN","KR","DE","FR","GB","JP"],i=s[Math.floor(Math.random()*s.length)],t=d[Math.floor(Math.random()*d.length)],x=()=>`${Math.floor(Math.random()*256)}.${Math.floor(Math.random()*256)}.${Math.floor(Math.random()*256)}.${Math.floor(Math.random()*256)}`;return{id:crypto.randomUUID(),timestamp:new Date,source:"Kaspersky Threat Intelligence",threatType:i,severity:t,indicator:x(),indicatorType:"ip",confidence:70+Math.random()*30,country:r[Math.floor(Math.random()*r.length)],description:`${i.toUpperCase()} activity detected via Kaspersky Global Threat Network`,tags:["kaspersky",i,t,"apt"]}}function ye(){const s=["zeus","emotet","trickbot","ryuk","wannacry","locky"],d=s[Math.floor(Math.random()*s.length)],r=()=>`malicious-${Math.random().toString(36).substr(2,8)}.com`;return{id:crypto.randomUUID(),timestamp:new Date,source:"Bitdefender Threat Intel",threatType:"malware",severity:Math.random()>.7?"critical":"high",indicator:r(),indicatorType:"domain",confidence:80+Math.random()*20,description:`${d.toUpperCase()} malware family detected by GravityZone`,tags:["bitdefender","malware",d,"c2"]}}function be(){const s=["file-encryption","registry-modification","network-scan","credential-theft"],d=s[Math.floor(Math.random()*s.length)],r=()=>Array.from({length:64},()=>Math.floor(Math.random()*16).toString(16)).join("");return{id:crypto.randomUUID(),timestamp:new Date,source:"ANY.RUN Sandbox",threatType:"malware",severity:d==="file-encryption"?"critical":"high",indicator:r(),indicatorType:"hash",confidence:90+Math.random()*10,description:`Behavioral analysis: ${d} detected in sandbox environment`,tags:["anyrun","sandbox",d,"dynamic-analysis"]}}const Ae=()=>{const{totalEventsProcessed:s,eventsPerSecond:d,anomalies:r,bettiNumbers:i,isConnected:t}=L(),{activeSourceIds:x,sourceStats:h}=oe(),[c,a]=g.useState([]);g.useEffect(()=>{const n=()=>{const j=[];for(let D=0;D<3;D++)Math.random()>.5&&j.push(ve()),Math.random()>.5&&j.push(ye()),Math.random()>.7&&j.push(be());a(j.slice(0,6))};n();const l=setInterval(n,1e4);return()=>clearInterval(l)},[]);const o=g.useMemo(()=>{let n=0,l=0;Object.values(h).forEach(k=>{n+=k.total,l+=k.eps});const j=r.filter(k=>k.severity==="critical").length,D=r.filter(k=>k.severity==="warning").length;return{totalEvents:s+n,eventsPerSecond:d+l,criticalAnomalies:j,warningAnomalies:D,totalAnomalies:r.length,avgBetti:Math.round((i.h0+i.h1+i.h2)/3),threatScore:Math.floor(50+Math.random()*30)}},[s,d,r,i,h]),f=[{title:"Total Events Processed",value:o.totalEvents.toLocaleString(),change:"+12.5%",trend:"up",icon:se,color:"text-primary",bgColor:"bg-primary/10"},{title:"Current Throughput",value:`${o.eventsPerSecond}/s`,change:t||x.size>0?"Live":"Paused",trend:t||x.size>0?"up":"stable",icon:ae,color:"text-success",bgColor:"bg-success/10"},{title:"Anomalies Detected",value:o.totalAnomalies.toString(),change:`${o.criticalAnomalies} critical`,trend:o.criticalAnomalies>0?"down":"stable",icon:A,color:"text-anomaly",bgColor:"bg-anomaly/10"},{title:"Threat Intelligence Score",value:o.threatScore.toString(),change:"Real-time",trend:"stable",icon:T,color:"text-info",bgColor:"bg-info/10"}];return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(de,{}),e.jsxs("main",{className:"pt-20 pb-8 px-4 sm:px-6 lg:px-8 max-w-[1600px] mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsxs(m.h1,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(ie,{className:"w-6 h-6 text-primary"}),"Advanced Analytics"]}),e.jsx(m.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.1},className:"text-sm text-muted-foreground mt-1",children:"Comprehensive threat intelligence and performance metrics"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-slate-800/50 p-1 rounded-lg border border-slate-700/50",children:[e.jsx(p,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs hover:bg-slate-700",children:"1h"}),e.jsx(p,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs bg-slate-700 text-white shadow-sm",children:"24h"}),e.jsx(p,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs hover:bg-slate-700",children:"7d"}),e.jsx(p,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs hover:bg-slate-700",children:"30d"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground bg-slate-800/30 px-3 py-1.5 rounded-md border border-slate-700/30",children:[e.jsx(re,{className:"w-4 h-4"}),e.jsx("span",{children:new Date().toLocaleDateString()})]})]})]}),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:f.map((n,l)=>e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:l*.1},children:e.jsx(b,{variant:"glass",className:"h-full",children:e.jsxs(N,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${n.bgColor}`,children:e.jsx(n.icon,{className:`w-5 h-5 ${n.color}`})}),e.jsxs("div",{className:`flex items-center gap-1 text-xs ${n.trend==="up"?"text-success":n.trend==="down"?"text-critical":"text-muted-foreground"}`,children:[n.trend==="up"&&e.jsx(B,{className:"w-3 h-3"}),n.trend==="down"&&e.jsx(ne,{className:"w-3 h-3"}),e.jsx("span",{children:n.change})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wider mb-1",children:n.title}),e.jsx("p",{className:"text-2xl font-bold font-mono",children:n.value})]})})},n.title))}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6 mb-6",children:[e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:e.jsx(pe,{})}),e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:e.jsx(fe,{})})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6 mb-6",children:[e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},children:e.jsxs(b,{children:[e.jsx(C,{children:e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5"}),"Live Threat Intelligence"]})}),e.jsx(N,{children:e.jsxs("div",{className:"space-y-3 max-h-[500px] overflow-y-auto",children:[c.map((n,l)=>e.jsx(he,{threat:n,index:l},n.id)),c.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(T,{className:"w-12 h-12 mx-auto mb-2 opacity-20"}),e.jsx("p",{className:"text-sm",children:"No threats detected"})]})]})})]})}),e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7},children:e.jsx(ge,{})})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6 mb-6",children:[e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},children:e.jsx(je,{})}),e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9},children:e.jsx(ue,{})})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1},children:e.jsxs(b,{variant:"glass",children:[e.jsx(C,{children:e.jsx(S,{className:"text-sm font-medium",children:"Betti Number Distribution"})}),e.jsx(N,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-topo-h0",children:"β₀ (Components)"}),e.jsx("span",{className:"font-mono font-semibold",children:i.h0})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:e.jsx(m.div,{className:"bg-topo-h0 h-2 rounded-full",initial:{width:0},animate:{width:`${Math.min(i.h0*2,100)}%`}})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-topo-h1",children:"β₁ (Loops)"}),e.jsx("span",{className:"font-mono font-semibold",children:i.h1})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:e.jsx(m.div,{className:"bg-topo-h1 h-2 rounded-full",initial:{width:0},animate:{width:`${Math.min(i.h1*3,100)}%`}})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-topo-h2",children:"β₂ (Voids)"}),e.jsx("span",{className:"font-mono font-semibold",children:i.h2})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:e.jsx(m.div,{className:"bg-topo-h2 h-2 rounded-full",initial:{width:0},animate:{width:`${Math.min(i.h2*10,100)}%`}})})]})})]})}),e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.1},children:e.jsxs(b,{variant:"glass",children:[e.jsx(C,{children:e.jsx(S,{className:"text-sm font-medium",children:"Anomaly Breakdown"})}),e.jsx(N,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-critical/10 border border-critical/20",children:[e.jsx("span",{className:"text-sm text-critical",children:"Critical"}),e.jsx(w,{variant:"critical",children:o.criticalAnomalies})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-anomaly/10 border border-anomaly/20",children:[e.jsx("span",{className:"text-sm text-anomaly",children:"Warning"}),e.jsx(w,{variant:"anomaly",children:o.warningAnomalies})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-info/10 border border-info/20",children:[e.jsx("span",{className:"text-sm text-info",children:"Info"}),e.jsx(w,{variant:"info",children:r.filter(n=>n.severity==="info").length})]})]})})]})}),e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.2},children:e.jsxs(b,{variant:"glass",children:[e.jsx(C,{children:e.jsxs(S,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4"}),"Data Sources Active"]})}),e.jsx(N,{children:e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Wikipedia"}),e.jsx(w,{variant:t?"success":"outline",children:t?"Live":"Off"})]}),Array.from(x).slice(0,4).map(n=>{const l=me.find(j=>j.id===n);return e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground truncate max-w-[120px]",children:(l==null?void 0:l.name)||n}),e.jsx(w,{variant:"success",children:"Live"})]},n)}),e.jsxs("div",{className:"text-xs text-muted-foreground pt-2 border-t",children:["Total: ",x.size+(t?1:0)," active streams"]})]})})]})})]})]})]})};export{Ae as default};
