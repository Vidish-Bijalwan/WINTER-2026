import{r as n,j as e,o as N,v as b,as as T,a_ as P,a$ as F,G as $}from"./vendor-BJtIU4cE.js";import{N as I}from"./Navigation-CchaNxGk.js";import{C as L,d as R}from"./card-CjP5KoZO.js";import{D as B,a as O,b as z,c as W,d as _,f as G,B as x}from"./dialog-B7IIvyeJ.js";import{B as c}from"./button-ZZWTDpQH.js";import{u as M,a as U,A as h}from"./index-DT2D_i0V.js";import{I as l}from"./input-C61Tg8Hq.js";import{L as d}from"./label-3v_expCV.js";const Z=()=>{const{isConnected:t,connect:y,disconnect:S,eventsPerSecond:u,totalEventsProcessed:g}=M(),{toast:o}=U(),[w,j]=n.useState([]),[C,v]=n.useState(!1),[a,i]=n.useState({name:"",url:"",type:"Custom",description:""}),f=[{id:"wikipedia",name:"Wikipedia Recent Changes",description:"Real-time SSE stream of all Wikipedia edits across all languages",type:"Social Media",protocol:"SSE",icon:$,url:"stream.wikimedia.org",eventsPerSecond:t?u:0,totalEvents:t?g:0,color:"text-blue-500",bgColor:"bg-blue-500/10",active:t}],m=async()=>{try{const s=await fetch(`${h}/api/sources/`);if(s.ok){const p=(await s.json()).map(A=>({...A,icon:b,protocol:"REST",eventsPerSecond:0,totalEvents:0,color:"text-green-500",bgColor:"bg-green-500/10"}));j([...f,...p])}}catch(s){console.error("Failed to fetch sources:",s),j(f)}};n.useEffect(()=>{m()},[t,u,g]);const D=async()=>{try{(await fetch(`${h}/api/sources/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok?(o({title:"Source Added",description:"New data source configured successfully."}),v(!1),i({name:"",url:"",type:"Custom",description:""}),m()):o({title:"Error",description:"Failed to add source.",variant:"destructive"})}catch{o({title:"Error",description:"Network error.",variant:"destructive"})}},k=async s=>{if(s!=="wikipedia")try{(await fetch(`${h}/api/sources/${s}`,{method:"DELETE"})).ok&&(o({title:"Source Deleted",description:"Data source removed."}),m())}catch(r){console.error("Delete failed",r)}},E=s=>{s==="wikipedia"&&(t?S():y())};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(I,{}),e.jsxs("main",{className:"pt-20 pb-8 px-4 sm:px-6 lg:px-8 max-w-[1400px] mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsxs(N.h1,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(b,{className:"w-6 h-6 text-primary"}),"Data Sources"]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Manage your real-time data stream connections"})]}),e.jsxs(B,{open:C,onOpenChange:v,children:[e.jsx(O,{asChild:!0,children:e.jsxs(c,{variant:"default",size:"sm",className:"gap-2",children:[e.jsx(T,{className:"w-4 h-4"}),"Add Custom Source"]})}),e.jsxs(z,{className:"bg-slate-900 border-slate-800 text-slate-100",children:[e.jsx(W,{children:e.jsx(_,{children:"Add New Data Source"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"name",children:"Name"}),e.jsx(l,{id:"name",value:a.name,onChange:s=>i({...a,name:s.target.value}),className:"bg-slate-800 border-slate-700"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"url",children:"URL / Endpoint"}),e.jsx(l,{id:"url",value:a.url,onChange:s=>i({...a,url:s.target.value}),className:"bg-slate-800 border-slate-700"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"type",children:"Type"}),e.jsx(l,{id:"type",value:a.type,onChange:s=>i({...a,type:s.target.value}),className:"bg-slate-800 border-slate-700"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"desc",children:"Description"}),e.jsx(l,{id:"desc",value:a.description,onChange:s=>i({...a,description:s.target.value}),className:"bg-slate-800 border-slate-700"})]})]}),e.jsx(G,{children:e.jsx(c,{onClick:D,children:"Add Source"})})]})]})]}),e.jsx("div",{className:"grid gap-4",children:w.map((s,r)=>{const p=s.icon;return e.jsx(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:r*.05},children:e.jsx(L,{className:"overflow-hidden hover:border-primary/30 transition-all group",children:e.jsx(R,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${s.active?s.bgColor:"bg-muted"} transition-colors`,children:e.jsx(p,{className:`w-6 h-6 ${s.active?s.color:"text-muted-foreground"}`})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold",children:s.name}),s.active?e.jsx(x,{variant:"success",className:"animate-pulse",children:"Live"}):e.jsx(x,{variant:"outline",children:"Inactive"}),e.jsx(x,{variant:"secondary",className:"text-[10px]",children:s.type})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:s.description}),e.jsx("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:e.jsx("span",{className:"font-mono",children:s.url})})]}),e.jsx("div",{className:"flex items-center gap-2",children:s.id==="wikipedia"?e.jsxs(c,{variant:s.active?"outline":"default",size:"sm",onClick:()=>E(s.id),children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),s.active?"Disconnect":"Connect"]}):e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>k(s.id),className:"text-red-500 hover:text-red-400 hover:bg-red-500/10",children:e.jsx(F,{className:"w-4 h-4"})})})]})})})},s.id)})})]})]})};export{Z as default};
