const h="http://localhost:8000";class n extends Error{constructor(r,s,a){super(r),this.status=s,this.data=a,this.name="ApiError"}}async function o(t,r={}){const s=`${h}${t}`,a=localStorage.getItem("auth_token"),c={"Content-Type":"application/json",...r.headers};a&&(c.Authorization=`Bearer ${a}`);try{const e=await fetch(s,{...r,headers:c}),p=e.headers.get("content-type");if(!p||!p.includes("application/json")){if(!e.ok)throw new n("Server error",e.status);return{}}const i=await e.json();if(!e.ok)throw new n(i.detail||i.message||"Request failed",e.status,i);return i}catch(e){throw e instanceof n?e:new n(e instanceof Error?e.message:"Network error")}}const d={async login(t){const r=new URLSearchParams;r.append("username",t.username),r.append("password",t.password);const s=await fetch(`${h}/api/auth/login`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r});if(!s.ok){const a=await s.json();throw new n(a.detail||"Login failed",s.status,a)}return s.json()},async bypassLogin(){return o("/api/auth/bypass-login",{method:"POST"})},async register(t){return o("/api/auth/register",{method:"POST",body:JSON.stringify(t)})},async getProfile(){return o("/api/auth/me")},async forgotPassword(t){return o("/api/auth/forgot-password",{method:"POST",body:JSON.stringify({email:t})})},async resetPassword(t,r){return o("/api/auth/reset-password",{method:"POST",body:JSON.stringify({token:t,new_password:r})})}};export{h as A,d as a};
