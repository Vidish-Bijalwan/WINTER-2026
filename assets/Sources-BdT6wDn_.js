import{r as n,j as e,o as f,v as N,as as T,a_ as A,a$ as F,G as P}from"./vendor-BJtIU4cE.js";import{N as I}from"./Navigation-Cz8Jqmw2.js";import{C as L,d as O}from"./card-DIWLR2ex.js";import{D as R,a as B,b as $,c as z,d as W,f as G,B as x}from"./dialog-B4uVXCRd.js";import{B as l}from"./button-D9m3P4MM.js";import{u as M,a as H}from"./index-DvM1YsZ_.js";import{I as c}from"./input-B8i-_Nc8.js";import{L as d}from"./label-vCZy8n3v.js";const Y=()=>{const{isConnected:t,connect:b,disconnect:y,eventsPerSecond:h,totalEventsProcessed:u}=M(),{toast:o}=H(),[S,g]=n.useState([]),[w,j]=n.useState(!1),[a,i]=n.useState({name:"",url:"",type:"Custom",description:""}),v=[{id:"wikipedia",name:"Wikipedia Recent Changes",description:"Real-time SSE stream of all Wikipedia edits across all languages",type:"Social Media",protocol:"SSE",icon:P,url:"stream.wikimedia.org",eventsPerSecond:t?h:0,totalEvents:t?u:0,color:"text-blue-500",bgColor:"bg-blue-500/10",active:t}],m=async()=>{try{const s=await fetch("http://localhost:8000/api/sources/");if(s.ok){const p=(await s.json()).map(E=>({...E,icon:N,protocol:"REST",eventsPerSecond:0,totalEvents:0,color:"text-green-500",bgColor:"bg-green-500/10"}));g([...v,...p])}}catch(s){console.error("Failed to fetch sources:",s),g(v)}};n.useEffect(()=>{m()},[t,h,u]);const C=async()=>{try{(await fetch("http://localhost:8000/api/sources/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok?(o({title:"Source Added",description:"New data source configured successfully."}),j(!1),i({name:"",url:"",type:"Custom",description:""}),m()):o({title:"Error",description:"Failed to add source.",variant:"destructive"})}catch{o({title:"Error",description:"Network error.",variant:"destructive"})}},D=async s=>{if(s!=="wikipedia")try{(await fetch(`http://localhost:8000/api/sources/${s}`,{method:"DELETE"})).ok&&(o({title:"Source Deleted",description:"Data source removed."}),m())}catch(r){console.error("Delete failed",r)}},k=s=>{s==="wikipedia"&&(t?y():b())};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(I,{}),e.jsxs("main",{className:"pt-20 pb-8 px-4 sm:px-6 lg:px-8 max-w-[1400px] mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsxs(f.h1,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(N,{className:"w-6 h-6 text-primary"}),"Data Sources"]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Manage your real-time data stream connections"})]}),e.jsxs(R,{open:w,onOpenChange:j,children:[e.jsx(B,{asChild:!0,children:e.jsxs(l,{variant:"default",size:"sm",className:"gap-2",children:[e.jsx(T,{className:"w-4 h-4"}),"Add Custom Source"]})}),e.jsxs($,{className:"bg-slate-900 border-slate-800 text-slate-100",children:[e.jsx(z,{children:e.jsx(W,{children:"Add New Data Source"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"name",children:"Name"}),e.jsx(c,{id:"name",value:a.name,onChange:s=>i({...a,name:s.target.value}),className:"bg-slate-800 border-slate-700"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"url",children:"URL / Endpoint"}),e.jsx(c,{id:"url",value:a.url,onChange:s=>i({...a,url:s.target.value}),className:"bg-slate-800 border-slate-700"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"type",children:"Type"}),e.jsx(c,{id:"type",value:a.type,onChange:s=>i({...a,type:s.target.value}),className:"bg-slate-800 border-slate-700"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"desc",children:"Description"}),e.jsx(c,{id:"desc",value:a.description,onChange:s=>i({...a,description:s.target.value}),className:"bg-slate-800 border-slate-700"})]})]}),e.jsx(G,{children:e.jsx(l,{onClick:C,children:"Add Source"})})]})]})]}),e.jsx("div",{className:"grid gap-4",children:S.map((s,r)=>{const p=s.icon;return e.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:r*.05},children:e.jsx(L,{className:"overflow-hidden hover:border-primary/30 transition-all group",children:e.jsx(O,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${s.active?s.bgColor:"bg-muted"} transition-colors`,children:e.jsx(p,{className:`w-6 h-6 ${s.active?s.color:"text-muted-foreground"}`})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold",children:s.name}),s.active?e.jsx(x,{variant:"success",className:"animate-pulse",children:"Live"}):e.jsx(x,{variant:"outline",children:"Inactive"}),e.jsx(x,{variant:"secondary",className:"text-[10px]",children:s.type})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:s.description}),e.jsx("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:e.jsx("span",{className:"font-mono",children:s.url})})]}),e.jsx("div",{className:"flex items-center gap-2",children:s.id==="wikipedia"?e.jsxs(l,{variant:s.active?"outline":"default",size:"sm",onClick:()=>k(s.id),children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),s.active?"Disconnect":"Connect"]}):e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>D(s.id),className:"text-red-500 hover:text-red-400 hover:bg-red-500/10",children:e.jsx(F,{className:"w-4 h-4"})})})]})})})},s.id)})})]})]})};export{Y as default};
