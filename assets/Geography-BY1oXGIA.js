import{r as d,j as t,bd as y,be as j,bf as v,bg as w,bh as M,bi as k,bj as O,bk as R,bl as z,bm as P,bn as A,bo as L,bp as T,bq as S,o as x,G as F,a_ as G}from"./vendor-DukLKV3j.js";import{N as I}from"./Navigation-B2R97OZ2.js";import{u as f}from"./index-DMsRMC1O.js";import{B as N}from"./button-DnCoHbkF.js";import{S as B}from"./slider-BrGmlOxn.js";import{B as E}from"./badge-CL0qBMqV.js";const b={US:{lat:39.8283,lng:-98.5795,name:"United States"},GB:{lat:55.3781,lng:-3.436,name:"United Kingdom"},DE:{lat:51.1657,lng:10.4515,name:"Germany"},FR:{lat:46.2276,lng:2.2137,name:"France"},ES:{lat:40.4637,lng:-3.7492,name:"Spain"},IT:{lat:41.8719,lng:12.5674,name:"Italy"},CN:{lat:35.8617,lng:104.1954,name:"China"},JP:{lat:36.2048,lng:138.2529,name:"Japan"},IN:{lat:20.5937,lng:78.9629,name:"India"},RU:{lat:61.524,lng:105.3188,name:"Russia"},BR:{lat:-14.235,lng:-51.9253,name:"Brazil"},CA:{lat:56.1304,lng:-106.3468,name:"Canada"},AU:{lat:-25.2744,lng:133.7751,name:"Australia"},KR:{lat:35.9078,lng:127.7669,name:"South Korea"},MX:{lat:23.6345,lng:-102.5528,name:"Mexico"},NL:{lat:52.1326,lng:5.2913,name:"Netherlands"},SE:{lat:60.1282,lng:18.6435,name:"Sweden"},PL:{lat:51.9194,lng:19.1451,name:"Poland"},AR:{lat:-38.4161,lng:-63.6167,name:"Argentina"},ZA:{lat:-30.5595,lng:22.9375,name:"South Africa"}},U={"en.wikipedia.org":"US","de.wikipedia.org":"DE","fr.wikipedia.org":"FR","es.wikipedia.org":"ES","it.wikipedia.org":"IT","ja.wikipedia.org":"JP","zh.wikipedia.org":"CN","ru.wikipedia.org":"RU","pt.wikipedia.org":"BR","nl.wikipedia.org":"NL","pl.wikipedia.org":"PL","sv.wikipedia.org":"SE","ko.wikipedia.org":"KR"};function g(o){try{const l=new URL(o.serverUrl).hostname,c=U[l]||"US",i=b[c];if(i){const n=(Math.random()-.5)*10,e=(Math.random()-.5)*10;return{lat:i.lat+n,lng:i.lng+e,country:i.name,countryCode:c}}}catch(s){console.warn("Failed to extract geo from event",s)}return null}function D(o,s,l=50){const c=[];for(let i=0;i<=l;i++){const n=i/l,e=o.lat+(s.lat-o.lat)*n,r=o.lng+(s.lng-o.lng)*n,a=Math.sin(n*Math.PI)*.2;c.push([r,e+a])}return c}function J(o){const s={};return o.forEach(l=>{const c=g(l);c&&(s[c.countryCode]=(s[c.countryCode]||0)+1)}),s}function Z(o,s){const l=o/s;return l>.75?"#dc2626":l>.5?"#f97316":l>.25?"#fbbf24":"#34d399"}function $({markers:o}){return t.jsx(t.Fragment,{children:o.map(s=>t.jsx(v,{center:s.position,radius:8,pathOptions:{fillColor:s.event.bot?"#6366f1":"#10b981",fillOpacity:.7,color:"#fff",weight:2},children:t.jsx(w,{children:t.jsxs("div",{className:"text-sm",children:[t.jsx("div",{className:"font-semibold",children:s.event.title}),t.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["By: ",s.event.user]}),t.jsx("div",{className:"text-xs text-muted-foreground",children:s.geo.country}),t.jsx("div",{className:"text-xs text-muted-foreground",children:s.event.timestamp.toLocaleTimeString()})]})})},s.id))})}function K({className:o}){const{events:s}=f(),[l,c]=d.useState([]);return d.useEffect(()=>{const i=s.slice(0,100).map(n=>{const e=g(n);return e?{id:n.id,position:[e.lat,e.lng],event:n,geo:e,timestamp:n.timestamp.getTime()}:null}).filter(n=>n!==null);c(i)},[s]),t.jsx("div",{className:o,children:t.jsxs(y,{center:[20,0],zoom:2,style:{height:"100%",width:"100%"},className:"rounded-lg",children:[t.jsx(j,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> © <a href="https://carto.com/attributions">CARTO</a>',url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png"}),t.jsx($,{markers:l})]})})}function W({className:o}){const{events:s}=f(),[l,c]=d.useState([]);d.useEffect(()=>{const n=new Map;s.forEach(r=>{const a=g(r);if(!a)return;const m=`${Math.round(a.lat)},${Math.round(a.lng)}`,u=n.get(m);u?u.count++:n.set(m,{lat:Math.round(a.lat),lng:Math.round(a.lng),count:1})});const e=Array.from(n.values()).map(r=>({lat:r.lat,lng:r.lng,intensity:r.count}));c(e)},[s]);const i=Math.max(...l.map(n=>n.intensity),1);return t.jsx("div",{className:o,children:t.jsxs(y,{center:[20,0],zoom:2,style:{height:"100%",width:"100%"},className:"rounded-lg",children:[t.jsx(j,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png"}),l.map((n,e)=>{const r=n.intensity/i,a=5e4*(n.intensity/i+.2);return t.jsx(M,{center:[n.lat,n.lng],radius:a,pathOptions:{fillColor:"#ef4444",fillOpacity:r*.6,color:"#f97316",weight:1,opacity:r*.8}},e)})]})})}function _({className:o}){const{events:s}=f(),[l,c]=d.useState([]);return d.useEffect(()=>{const i=[];for(let n=0;n<Math.min(s.length-1,50);n++){const e=g(s[n]),r=g(s[n+1]);if(e&&r&&e.countryCode!==r.countryCode){const a=D(e,r,30);i.push({id:`${s[n].id}-${s[n+1].id}`,path:a,color:s[n].bot?"#818cf8":"#34d399"})}}c(i)},[s]),t.jsx("div",{className:o,children:t.jsxs(y,{center:[20,0],zoom:2,style:{height:"100%",width:"100%"},className:"rounded-lg",children:[t.jsx(j,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://{s}.basemaps.cartocdn.com/dark_nolabels/{z}/{x}/{y}{r}.png"}),l.map(i=>t.jsx(k,{positions:i.path,pathOptions:{color:i.color,weight:2,opacity:.6}},i.id))]})})}function H({className:o}){const{events:s}=f(),[l,c]=d.useState({}),[i,n]=d.useState(1);d.useEffect(()=>{const a=J(s);c(a),n(Math.max(...Object.values(a),1))},[s]);const r={type:"FeatureCollection",features:Object.entries(l).map(([a,m])=>{const u=b[a];return u?{type:"Feature",properties:{name:u.name,code:a,count:m},geometry:{type:"Point",coordinates:[u.lng,u.lat]}}:null}).filter(Boolean)};return t.jsx("div",{className:o,children:t.jsxs("div",{className:"p-4 bg-card rounded-lg border",children:[t.jsx("h3",{className:"text-sm font-semibold mb-3",children:"Top Countries by Edit Volume"}),t.jsx("div",{className:"space-y-2 mb-4",children:Object.entries(l).sort(([,a],[,m])=>m-a).slice(0,5).map(([a,m])=>{const u=b[a];return u?t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{children:u.name}),t.jsx("span",{className:"font-mono text-primary",children:m})]},a):null})}),t.jsxs(y,{center:[20,0],zoom:2,style:{height:"400px",width:"100%"},className:"rounded-lg",children:[t.jsx(j,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),t.jsx(O,{data:r,pointToLayer:(a,m)=>{const u=a.properties.count,p=10+u/i*40;return R.circleMarker(m,{radius:p,fillColor:Z(u,i),fillOpacity:.7,color:"#fff",weight:2})},onEachFeature:(a,m)=>{m.bindPopup(`
                <b>${a.properties.name}</b><br/>
                Edits: ${a.properties.count}
              `)}})]})]})})}function V({className:o}){const{events:s}=f(),[l,c]=d.useState(!1),[i,n]=d.useState(0),[e,r]=d.useState({start:0,end:Date.now()}),a=d.useRef();d.useEffect(()=>{if(s.length>0){const p=s.map(h=>h.timestamp.getTime());r({start:Math.min(...p),end:Math.max(...p)}),n(Math.min(...p))}},[s]),d.useEffect(()=>(l?a.current=setInterval(()=>{n(p=>{const h=p+6e4;return h>e.end?(c(!1),e.start):h})},100):a.current&&clearInterval(a.current),()=>{a.current&&clearInterval(a.current)}),[l,e]);const u=s.filter(p=>p.timestamp.getTime()<=i&&p.timestamp.getTime()>=i-1e3*60*5).map(p=>{const h=g(p);return h?{event:p,geo:h,position:[h.lat,h.lng]}:null}).filter(Boolean);return t.jsx("div",{className:o,children:t.jsxs("div",{className:"p-4 bg-card rounded-lg border",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("h3",{className:"text-sm font-semibold",children:"24-Hour Time-lapse"}),t.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(i).toLocaleTimeString()})]}),t.jsxs(y,{center:[20,0],zoom:2,style:{height:"400px",width:"100%"},className:"rounded-lg mb-3",children:[t.jsx(j,{attribution:"© OpenStreetMap",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),u.map((p,h)=>p&&t.jsx(v,{center:p.position,radius:6,pathOptions:{fillColor:"#3b82f6",fillOpacity:.8,color:"#fff",weight:2}},h))]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx(B,{value:[i],min:e.start,max:e.end,step:1e3*60,onValueChange:([p])=>n(p),className:"w-full"}),t.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[t.jsx(N,{variant:"outline",size:"sm",onClick:()=>n(e.start),children:t.jsx(z,{className:"w-4 h-4"})}),t.jsx(N,{variant:"default",size:"sm",onClick:()=>c(!l),children:l?t.jsx(P,{className:"w-4 h-4"}):t.jsx(A,{className:"w-4 h-4"})})]})]})]})})}const C={en:"#3b82f6",de:"#eab308",fr:"#8b5cf6",es:"#f97316",it:"#10b981",ja:"#ec4899",zh:"#ef4444",ru:"#14b8a6",pt:"#06b6d4"};function q({className:o}){const{events:s}=f(),[l,c]=d.useState({}),[i,n]=d.useState([]);return d.useEffect(()=>{const e={},r=[];s.slice(0,200).forEach(a=>{const m=g(a);if(!m)return;const u=a.wiki.substring(0,2);e[u]=(e[u]||0)+1,r.push({position:[m.lat,m.lng],lang:u,event:a})}),c(e),n(r)},[s]),t.jsx("div",{className:o,children:t.jsxs("div",{className:"p-4 bg-card rounded-lg border",children:[t.jsx("h3",{className:"text-sm font-semibold mb-3",children:"Wiki Language Clusters"}),t.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:Object.entries(l).sort(([,e],[,r])=>r-e).slice(0,8).map(([e,r])=>t.jsxs(E,{variant:"secondary",style:{backgroundColor:C[e]+"33"},children:[e.toUpperCase(),": ",r]},e))}),t.jsxs(y,{center:[20,0],zoom:2,style:{height:"400px",width:"100%"},className:"rounded-lg",children:[t.jsx(j,{attribution:"© OpenStreetMap",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),i.map((e,r)=>t.jsx(v,{center:e.position,radius:5,pathOptions:{fillColor:C[e.lang]||"#gray",fillOpacity:.7,color:"#fff",weight:1},children:t.jsx(w,{children:t.jsxs("div",{className:"text-xs",children:[t.jsx("div",{className:"font-semibold",children:e.event.title}),t.jsxs("div",{className:"text-muted-foreground",children:["Language: ",e.lang.toUpperCase()]})]})})},r))]})]})})}function X({className:o}){const{events:s}=f(),[l,c]=d.useState([]);return d.useEffect(()=>{const i=new Map;s.forEach(e=>{const r=g(e);if(!r)return;const a=i.get(e.title);a?(a.edits++,a.editors.add(e.user)):i.set(e.title,{edits:1,editors:new Set([e.user]),geo:r})});const n=[];i.forEach((e,r)=>{e.edits>=3&&e.editors.size>=2&&n.push({title:r,position:[e.geo.lat,e.geo.lng],edits:e.edits,editors:e.editors})}),c(n.slice(0,20))},[s]),t.jsx("div",{className:o,children:t.jsxs("div",{className:"p-4 bg-card rounded-lg border",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("h3",{className:"text-sm font-semibold",children:"Edit Conflict Zones"}),t.jsxs(E,{variant:"destructive",children:[l.length," detected"]})]}),t.jsxs(y,{center:[20,0],zoom:2,style:{height:"400px",width:"100%"},className:"rounded-lg",children:[t.jsx(j,{attribution:"© OpenStreetMap",url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png"}),l.map((i,n)=>t.jsx(M,{center:i.position,radius:1e5,pathOptions:{fillColor:"#ef4444",fillOpacity:.4,color:"#fca5a5",weight:2},children:t.jsx(w,{children:t.jsxs("div",{className:"text-sm",children:[t.jsx("div",{className:"font-semibold text-red-500",children:"⚠️ Conflict Zone"}),t.jsx("div",{className:"mt-1",children:i.title}),t.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[i.edits," edits by ",i.editors.size," editors"]})]})})},n))]})]})})}function Q(){const{events:o}=f(),s=d.useRef(null),[l,c]=d.useState(new Float32Array(0));return d.useEffect(()=>{const i=[];o.slice(0,500).forEach(n=>{const e=g(n);if(!e)return;const r=(90-e.lat)*(Math.PI/180),a=(e.lng+180)*(Math.PI/180),m=2.1,u=-(m*Math.sin(r)*Math.cos(a)),p=m*Math.cos(r),h=m*Math.sin(r)*Math.sin(a);i.push(u,p,h)}),c(new Float32Array(i))},[o]),S(()=>{s.current&&(s.current.rotation.y+=.001)}),t.jsxs("points",{ref:s,children:[t.jsx("bufferGeometry",{children:t.jsx("bufferAttribute",{attach:"attributes-position",count:l.length/3,array:l,itemSize:3})}),t.jsx("pointsMaterial",{size:.05,color:"#10b981",sizeAttenuation:!0,transparent:!0,opacity:.8})]})}function Y(){const o=d.useRef(null);return S(()=>{o.current&&(o.current.rotation.y+=.002)}),t.jsxs("mesh",{ref:o,children:[t.jsx("sphereGeometry",{args:[2,64,64]}),t.jsx("meshStandardMaterial",{color:"#1e293b",wireframe:!0,opacity:.1,transparent:!0})]})}function tt({className:o}){return t.jsx("div",{className:o,children:t.jsxs("div",{className:"p-4 bg-card rounded-lg border",children:[t.jsx("h3",{className:"text-sm font-semibold mb-3",children:"3D Globe Visualization"}),t.jsx("div",{style:{height:"500px",width:"100%"},className:"rounded-lg overflow-hidden bg-slate-950",children:t.jsxs(L,{camera:{position:[0,0,5],fov:50},children:[t.jsx("ambientLight",{intensity:.5}),t.jsx("pointLight",{position:[10,10,10]}),t.jsx(Y,{}),t.jsx(Q,{}),t.jsx(T,{enableZoom:!0,enablePan:!1,minDistance:3,maxDistance:8})]})})]})})}const ot=()=>t.jsxs("div",{className:"min-h-screen bg-background",children:[t.jsx(I,{}),t.jsxs("main",{className:"pt-20 pb-8 px-4 sm:px-6 lg:px-8 max-w-[1800px] mx-auto",children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs(x.h1,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-2xl font-bold flex items-center gap-2",children:[t.jsx(F,{className:"w-6 h-6 text-primary"}),"Geographic Intelligence"]}),t.jsx(x.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.1},className:"text-sm text-muted-foreground mt-1",children:"Real-time visualization of global Wikipedia edit activity"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"lg:col-span-2",children:t.jsxs("div",{className:"p-4 bg-card rounded-lg border",children:[t.jsxs("h3",{className:"text-sm font-semibold mb-3 flex items-center gap-2",children:[t.jsx(G,{className:"w-4 h-4 text-primary"}),"Live World Map"]}),t.jsx(K,{className:"h-[500px]"})]})}),t.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:t.jsx(W,{className:"h-[500px]"})}),t.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:t.jsxs("div",{className:"p-4 bg-card rounded-lg border",children:[t.jsx("h3",{className:"text-sm font-semibold mb-3",children:"Edit Flow Arcs"}),t.jsx(_,{className:"h-[460px]"})]})}),t.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:t.jsx(H,{})}),t.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:t.jsx(V,{})}),t.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},children:t.jsx(q,{})}),t.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7},children:t.jsx(X,{})}),t.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},className:"lg:col-span-2",children:t.jsx(tt,{})})]})]})]});export{ot as default};
